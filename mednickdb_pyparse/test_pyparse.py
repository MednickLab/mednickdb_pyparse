from .mednickdb_auto_parse import automated_parsing
import os
import datetime

# tests for python parsing part of mednickdb


def test_multiline_tabular():
    dict_out = automated_parsing(filepath="testfiles/testtabular1.xlsx",
                                 fileformat="tabular",
                                 filetype="Demographics",
                                 studyid="ExampleStudyA")
    s1 = {
        "studyid": "ExampleStudyA",
        "filetype": "Demographics",
        "fileformat": "tabular",
        "subjectid": 1,
        "age": 18,
        "sex": "M",
        "bmi": 22
    }

    s2 = {
        "studyid": "ExampleStudyA",
        "filetype": "Demographics",
        "fileformat": "tabular",
        "subjectid": 2,
        "age": 22,
        "sex": "F",
        "bmi": 23
    }

    s3 = {
        "studyid": "ExampleStudyA",
        "filetype": "Demographics",
        "fileformat": "tabular",
        "subjectid": 3,
        "age": 20,
        "sex": "M",
        "bmi": 19
    }

    correct_return = [s1, s2, s3]
    assert(all([True if dict_out[i] == corr_item else False for i, corr_item in enumerate(correct_return)]))


def test_example_task_data():
    """Task data is structured in some tabular format, and should be indexed by subject, visit, session"""
    dict_out = automated_parsing(filepath="testfiles/testexampletask1.xlsx",
                                 fileformat="tabular",
                                 filetype="ExampleTask1",
                                 studyid="ExampleStudyA")

    line1 = {
        "studyid": "ExampleStudyA",
        "filetype": "ExampleTask1",
        "fileformat": "tabular",
        "subjectid": 1.0,
        "visitid": 1.0,
        "sessionid": 1.0,
        "accuracy": 0.9,
        "rt": 30.0
    }

    line2 = {
        "studyid": "ExampleStudyA",
        "filetype": "ExampleTask1",
        "fileformat": "tabular",
        "subjectid": 1.0,
        "visitid": 2.0,
        "sessionid": 1.0,
        "accuracy": 0.8,
        "rt": 50.0
    }

    line3 = {
        "studyid": "ExampleStudyA",
        "filetype": "ExampleTask1",
        "fileformat": "tabular",
        "subjectid": 2.0,
        "visitid": 1.0,
        "sessionid": 1.0,
        "accuracy": 0.5,
        "rt": 20.0
    }

    line4 = {
        "studyid": "ExampleStudyA",
        "filetype": "ExampleTask1",
        "fileformat": "tabular",
        "subjectid": 2.0,
        "visitid": 2.0,
        "sessionid": 1.0,
        "accuracy": 0.8,
        "rt": 50.0
    }

    correct_return = [line1, line2, line3, line4]

    assert(all([True if dict_out[i] == corr_item else False for i, corr_item  in enumerate(correct_return)]))


def test_edf_parse():
    dict_out = automated_parsing(filepath="testfiles/edf1.edf",
                                 fileformat="sleep",
                                 filetype="Raw Sleep",
                                 subjectid=1,
                                 visitid=1,
                                 sessionid=1,
                                 studyid="ExampleStudyA")

    correct_return = {
        "studyid": "ExampleStudyA",
        "subjectid": 1,
        "visitid": 1,
        "session": 1,
        "filetype": "Raw Sleep",
        "fileformat": "sleep",
        "edf_meas_date": datetime.datetime(2002, 12, 31, 16, 25, 37),
        "edf_nchan": 14,
        "edf_sfreq": 128.0,
        "edf_subject_info": None,
        "edf_ch_names": ["Lefteye", "RightEye", "EMG", "C3A2", "C4A1", "ECG", "SpO2", "Soud", "Flow", "Sum", "ribcage",
                         "abdo", "BodyPos", "Pulse"]
    }

    assert (dict_out == correct_return)


def test_mat_scorefile():
    dict_out = automated_parsing(filepath="testfiles/mattype_scorefile.mat",
                                 fileformat="scorefile",
                                 filetype="Scoring",
                                 subjectid=2,
                                 visitid=1,
                                 sessionid=1,
                                 studyid="GSF")

    correct_return = {"studyid": "GSF", "subjectid": 2, "visitid": 1, "session": 1, "filetype": "Scoring",
                      "fileformat": "scorefile", "epochstage": [0, 0, 1, 1, 2, 2, 3, 3, 2, 2],
                      "epochoffset": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0],
                      "starttime": datetime.datetime(2016, 1, 1, 0, 1, 42, 841003), "mins_in_0": 1.0, "mins_in_1": 1.0, "mins_in_2": 2.0,
                      "mins_in_3": 1.0, "sleep_efficiency": 0.8, "total_sleep_time": 4.0}

    assert (dict_out == correct_return)


def test_grass_scorefile():
    dict_out = automated_parsing(filepath="testfiles/grasstype_scorefile.xls",
                                 fileformat="scorefile",
                                 filetype="Scoring",
                                 subjectid=2,
                                 visitid=1,
                                 sessionid=1,
                                 studyid="ExampleStudyA")

    correct_return = {
        "studyid": "ExampleStudyA",
        "subjectid": 2,
        "visitid": 1,
        "session": 1,
        "filetype": "Scoring",
        "fileformat": "scorefile",
        "epochoffset": [0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 330, 360, 390, 420, 450, 480, 510, 540, 570,
                        600, 630, 660, 690, 720, 750, 780, 810, 840, 870, 900, 930, 960, 990, 1020, 1050, 1080, 1110,
                        1140, 1170, 1200, 1230, 1260, 1290, 1320, 1350, 1380, 1410, 1440, 1470, 1500, 1530, 1560, 1590,
                        1620, 1650, 1680, 1710, 1740, 1770, 1800, 1830, 1860, 1890, 1920, 1950, 1980, 2010, 2040, 2070,
                        2100, 2130, 2160, 2190, 2220, 2250, 2280, 2310, 2340, 2370, 2400, 2430, 2460, 2490, 2520, 2550,
                        2580, 2610, 2640, 2670, 2700, 2730, 2760, 2790, 2820, 2850, 2880, 2910, 2940, 2970, 3000, 3030,
                        3060, 3090, 3120, 3150, 3180, 3210, 3240, 3270, 3300, 3330, 3360, 3390, 3420, 3450, 3480, 3510,
                        3540, 3570, 3600, 3630, 3660, 3690, 3720, 3750, 3780, 3810, 3840, 3870, 3900, 3930, 3960, 3990,
                        4020, 4050, 4080, 4110, 4140, 4170, 4200, 4230, 4260, 4290, 4320, 4350, 4380, 4410, 4440, 4470,
                        4500, 4530, 4560, 4590, 4620, 4650, 4680, 4710, 4740, 4770, 4800, 4830, 4860, 4890, 4920, 4950,
                        4980, 5010, 5040, 5070, 5100, 5130, 5160, 5190, 5220, 5250, 5280, 5310, 5340, 5370, 5400, 5430,
                        5460, 5490, 5520, 5550, 5580, 5610, 5640, 5670, 5700, 5730, 5760, 5790, 5820, 5850, 5880, 5910,
                        5940, 5970, 6000, 6030, 6060, 6090, 6120, 6150, 6180, 6210, 6240, 6270, 6300, 6330, 6360, 6390,
                        6420, 6450, 6480, 6510, 6540, 6570, 6600, 6630, 6660, 6690, 6720, 6750, 6780, 6810, 6840, 6870,
                        6900, 6930, 6960, 6990, 7020, 7050, 7080, 7110, 7140, 7170, 7200, 7230, 7260, 7290, 7320, 7350,
                        7380, 7410, 7440, 7470, 7500, 7530, 7560, 7590, 7620, 7650, 7680, 7710, 7740, 7770, 7800, 7830,
                        7860, 7890, 7920, 7950, 7980, 8010, 8040, 8070, 8100, 8130, 8160, 8190, 8220, 8250, 8280, 8310,
                        8340, 8370, 8400, 8430, 8460, 8490, 8520, 8550, 8580, 8610, 8640, 8670, 8700, 8730, 8760, 8790,
                        8820, 8850, 8880, 8910, 8940, 8970, 9000, 9030, 9060, 9090, 9120, 9150, 9180, 9210, 9240, 9270,
                        9300, 9330, 9360, 9390],
        "epochstage": [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                       -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                       -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 1, 0, 1, 1, 1, 2, 2, 0, 1, 0, 1, 2, 2, 2, 2, 2, 2, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 1, 1, 0, 1, 0, 1, 0, 1, 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 0, 1, 2, 0, 1, 2, 4, 4, 0, 1, 4, 4,
                       4, 4, 4, 4, 0, 4, 4, 4, 4, 4, 4, 0, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0,
                       -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
        "starttime": datetime.datetime(2013, 2, 18, 12, 58, 59),
        "mins_in_0": 40.0, "mins_in_1": 10.0, "mins_in_2": 23.0, "mins_in_3": 34.0, "mins_in_4": 16.0,
        "sleep_efficiency": 0.6747967479674797, "total_sleep_time": 83.0
    }

    assert (dict_out == correct_return)


def test_lat_scorefile():
    dict_out = automated_parsing(filepath="testfiles/lattype_scorefile.txt",
                                 fileformat="scorefile",
                                 filetype="Scoring",
                                 subjectid=2,
                                 visitid=1,
                                 sessionid=1,
                                 studyid="SpencerLab")

    correct_return = {
        "studyid": "SpencerLab",
        "subjectid": 2,
        "visitid": 1,
        "session": 1,
        "filetype": "Scoring",
        "fileformat": "scorefile",
        "epochstage": [-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 2, 2, 1, 0, 1, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0,
                       1, 0, 1, 2, 2, 0, 2, 2, 1, 2, 2, 2, 0, 2, 2, 2, 2, 2, 2, 4, 1, 2, 2, 4, 4, 2, 2, 2, 1, 2, 4, 4,
                       4, 4, 4, 0, 1, 1, 0, 1, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 0, 4, 4, 4, 4, 1, 4, 4, 4, 4, 4, 4,
                       4, 4, 1, 0, 0, 1, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 0],
        "epochoffset": [0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 330, 360, 390, 420, 450, 480, 510, 540, 570,
                        600, 630, 660, 690, 720, 750, 780, 810, 840, 870, 900, 930, 960, 990, 1020, 1050, 1080, 1110,
                        1140, 1170, 1200, 1230, 1260, 1290, 1320, 1350, 1380, 1410, 1440, 1470, 1500, 1530, 1560, 1590,
                        1620, 1650, 1680, 1710, 1740, 1770, 1800, 1830, 1860, 1890, 1920, 1950, 1980, 2010, 2040, 2070,
                        2100, 2130, 2160, 2190, 2220, 2250, 2280, 2310, 2340, 2370, 2400, 2430, 2460, 2490, 2520, 2550,
                        2580, 2610, 2640, 2670, 2700, 2730, 2760, 2790, 2820, 2850, 2880, 2910, 2940, 2970, 3000, 3030,
                        3060, 3090, 3120, 3150, 3180, 3210, 3240, 3270, 3300, 3330, 3360, 3390, 3420, 3450, 3480, 3510,
                        3540, 3570, 3600, 3630, 3660, 3690, 3720, 3750, 3780, 3810, 3840, 3870, 3900, 3930, 3960, 3990,
                        4020, 4050, 4080, 4110, 4140, 4170, 4200, 4230, 4260, 4290, 4320, 4350, 4380, 4410, 4440, 4470,
                        4500, 4530, 4560, 4590, 4620, 4650, 4680, 4710, 4740, 4770, 4800, 4830, 4860, 4890, 4920, 4950,
                        4980, 5010, 5040, 5070, 5100, 5130, 5160, 5190, 5220, 5250, 5280, 5310, 5340, 5370, 5400, 5430,
                        5460, 5490, 5520, 5550, 5580, 5610, 5640, 5670, 5700, 5730, 5760, 5790, 5820, 5850, 5880, 5910,
                        5940, 5970, 6000, 6030, 6060, 6090, 6120],
        "mins_in_0": 12.0, "mins_in_1": 9.5, "mins_in_2": 33.0, "mins_in_3": 16.5, "mins_in_4": 29.5,
        "sleep_efficiency": 0.8805970149253731, "total_sleep_time": 88.5
    }

    assert (dict_out == correct_return)


def test_basic_scorefile():
    dict_out = automated_parsing(filepath="testfiles/basictype_scorefile.txt",
                                 fileformat="scorefile",
                                 filetype="Scoring",
                                 subjectid=2,
                                 visitid=1,
                                 sessionid=1,
                                 studyid="DinklemannLab")

    correct_return = {
        "studyid": "DinklemannLab",
        "subjectid": 2,
        "visitid": 1,
        "session": 1,
        "filetype": "Scoring",
        "fileformat": "scorefile",
        "epochstage": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0,
                       1, 0, 1, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 0, 0, 0, 1, 1, 1, 2, 2, 2, 2, 0, 1, 0,
                       0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 2, 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 3, 2, 2, 2, 3, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 0,
                       0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 4, 4, 2, 2, 2, 2, 1, 1, 2, 2, 2, 2, -3, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 3, 2, 2, 2, 3, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 0, 1, 2, 0, 1, 2, 0, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 2,
                       3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 2, 0, 0, 0, 0, 1, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -3, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 3, 3, 2, 2, 3, 2, 3, 3, 3, 3, 2,
                       3, 3, 3, 2, 2, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, -3, 1, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 1, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 2, 4, 4, 4, 4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, -3, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 3, 2, 3, 2, 3, 2, 2, 2, 2, 2, 2, 3, 3, 3, 2, 2, 2, 2, -3,
                       1, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -3, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0],
        "epochoffset": [0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 330, 360, 390, 420, 450, 480, 510, 540, 570,
                        600, 630, 660, 690, 720, 750, 780, 810, 840, 870, 900, 930, 960, 990, 1020, 1050, 1080, 1110,
                        1140, 1170, 1200, 1230, 1260, 1290, 1320, 1350, 1380, 1410, 1440, 1470, 1500, 1530, 1560, 1590,
                        1620, 1650, 1680, 1710, 1740, 1770, 1800, 1830, 1860, 1890, 1920, 1950, 1980, 2010, 2040, 2070,
                        2100, 2130, 2160, 2190, 2220, 2250, 2280, 2310, 2340, 2370, 2400, 2430, 2460, 2490, 2520, 2550,
                        2580, 2610, 2640, 2670, 2700, 2730, 2760, 2790, 2820, 2850, 2880, 2910, 2940, 2970, 3000, 3030,
                        3060, 3090, 3120, 3150, 3180, 3210, 3240, 3270, 3300, 3330, 3360, 3390, 3420, 3450, 3480, 3510,
                        3540, 3570, 3600, 3630, 3660, 3690, 3720, 3750, 3780, 3810, 3840, 3870, 3900, 3930, 3960, 3990,
                        4020, 4050, 4080, 4110, 4140, 4170, 4200, 4230, 4260, 4290, 4320, 4350, 4380, 4410, 4440, 4470,
                        4500, 4530, 4560, 4590, 4620, 4650, 4680, 4710, 4740, 4770, 4800, 4830, 4860, 4890, 4920, 4950,
                        4980, 5010, 5040, 5070, 5100, 5130, 5160, 5190, 5220, 5250, 5280, 5310, 5340, 5370, 5400, 5430,
                        5460, 5490, 5520, 5550, 5580, 5610, 5640, 5670, 5700, 5730, 5760, 5790, 5820, 5850, 5880, 5910,
                        5940, 5970, 6000, 6030, 6060, 6090, 6120, 6150, 6180, 6210, 6240, 6270, 6300, 6330, 6360, 6390,
                        6420, 6450, 6480, 6510, 6540, 6570, 6600, 6630, 6660, 6690, 6720, 6750, 6780, 6810, 6840, 6870,
                        6900, 6930, 6960, 6990, 7020, 7050, 7080, 7110, 7140, 7170, 7200, 7230, 7260, 7290, 7320, 7350,
                        7380, 7410, 7440, 7470, 7500, 7530, 7560, 7590, 7620, 7650, 7680, 7710, 7740, 7770, 7800, 7830,
                        7860, 7890, 7920, 7950, 7980, 8010, 8040, 8070, 8100, 8130, 8160, 8190, 8220, 8250, 8280, 8310,
                        8340, 8370, 8400, 8430, 8460, 8490, 8520, 8550, 8580, 8610, 8640, 8670, 8700, 8730, 8760, 8790,
                        8820, 8850, 8880, 8910, 8940, 8970, 9000, 9030, 9060, 9090, 9120, 9150, 9180, 9210, 9240, 9270,
                        9300, 9330, 9360, 9390, 9420, 9450, 9480, 9510, 9540, 9570, 9600, 9630, 9660, 9690, 9720, 9750,
                        9780, 9810, 9840, 9870, 9900, 9930, 9960, 9990, 10020, 10050, 10080, 10110, 10140, 10170, 10200,
                        10230, 10260, 10290, 10320, 10350, 10380, 10410, 10440, 10470, 10500, 10530, 10560, 10590,
                        10620, 10650, 10680, 10710, 10740, 10770, 10800, 10830, 10860, 10890, 10920, 10950, 10980,
                        11010, 11040, 11070, 11100, 11130, 11160, 11190, 11220, 11250, 11280, 11310, 11340, 11370,
                        11400, 11430, 11460, 11490, 11520, 11550, 11580, 11610, 11640, 11670, 11700, 11730, 11760,
                        11790, 11820, 11850, 11880, 11910, 11940, 11970, 12000, 12030, 12060, 12090, 12120, 12150,
                        12180, 12210, 12240, 12270, 12300, 12330, 12360, 12390, 12420, 12450, 12480, 12510, 12540,
                        12570, 12600, 12630, 12660, 12690, 12720, 12750, 12780, 12810, 12840, 12870, 12900, 12930,
                        12960, 12990, 13020, 13050, 13080, 13110, 13140, 13170, 13200, 13230, 13260, 13290, 13320,
                        13350, 13380, 13410, 13440, 13470, 13500, 13530, 13560, 13590, 13620, 13650, 13680, 13710,
                        13740, 13770, 13800, 13830, 13860, 13890, 13920, 13950, 13980, 14010, 14040, 14070, 14100,
                        14130, 14160, 14190, 14220, 14250, 14280, 14310, 14340, 14370, 14400, 14430, 14460, 14490,
                        14520, 14550, 14580, 14610, 14640, 14670, 14700, 14730, 14760, 14790, 14820, 14850, 14880,
                        14910, 14940, 14970, 15000, 15030, 15060, 15090, 15120, 15150, 15180, 15210, 15240, 15270,
                        15300, 15330, 15360, 15390, 15420, 15450, 15480, 15510, 15540, 15570, 15600, 15630, 15660,
                        15690, 15720, 15750, 15780, 15810, 15840, 15870, 15900, 15930, 15960, 15990, 16020, 16050,
                        16080, 16110, 16140, 16170, 16200, 16230, 16260, 16290, 16320, 16350, 16380, 16410, 16440,
                        16470, 16500, 16530, 16560, 16590, 16620, 16650, 16680, 16710, 16740, 16770, 16800, 16830,
                        16860, 16890, 16920, 16950, 16980, 17010, 17040, 17070, 17100, 17130, 17160, 17190, 17220,
                        17250, 17280, 17310, 17340, 17370, 17400, 17430, 17460, 17490, 17520, 17550, 17580, 17610,
                        17640, 17670, 17700, 17730, 17760, 17790, 17820, 17850, 17880, 17910, 17940, 17970, 18000,
                        18030, 18060, 18090, 18120, 18150, 18180, 18210, 18240, 18270, 18300, 18330, 18360, 18390,
                        18420, 18450, 18480, 18510, 18540, 18570, 18600, 18630, 18660, 18690, 18720, 18750, 18780,
                        18810, 18840, 18870, 18900, 18930, 18960, 18990, 19020, 19050, 19080, 19110, 19140, 19170,
                        19200, 19230, 19260, 19290, 19320, 19350, 19380, 19410, 19440, 19470, 19500, 19530, 19560,
                        19590, 19620, 19650, 19680, 19710, 19740, 19770, 19800, 19830, 19860, 19890, 19920, 19950,
                        19980, 20010, 20040, 20070, 20100, 20130, 20160, 20190, 20220, 20250, 20280, 20310, 20340,
                        20370, 20400, 20430, 20460, 20490, 20520, 20550, 20580, 20610, 20640, 20670, 20700, 20730,
                        20760, 20790, 20820, 20850, 20880, 20910, 20940, 20970, 21000, 21030, 21060, 21090, 21120,
                        21150, 21180, 21210, 21240, 21270, 21300, 21330, 21360, 21390, 21420, 21450, 21480, 21510,
                        21540, 21570, 21600, 21630, 21660, 21690, 21720, 21750, 21780, 21810, 21840, 21870, 21900,
                        21930, 21960, 21990, 22020, 22050, 22080, 22110, 22140, 22170, 22200, 22230, 22260, 22290,
                        22320, 22350, 22380, 22410, 22440, 22470, 22500, 22530, 22560, 22590, 22620, 22650, 22680,
                        22710, 22740, 22770, 22800, 22830, 22860, 22890, 22920, 22950, 22980, 23010, 23040, 23070,
                        23100, 23130, 23160, 23190, 23220, 23250, 23280, 23310, 23340, 23370, 23400, 23430, 23460,
                        23490, 23520, 23550, 23580, 23610, 23640, 23670, 23700, 23730, 23760, 23790, 23820, 23850,
                        23880, 23910, 23940, 23970, 24000, 24030, 24060, 24090, 24120, 24150, 24180, 24210, 24240,
                        24270, 24300, 24330, 24360, 24390, 24420, 24450, 24480, 24510, 24540, 24570, 24600, 24630,
                        24660, 24690, 24720, 24750, 24780, 24810, 24840, 24870, 24900, 24930, 24960, 24990, 25020,
                        25050, 25080, 25110, 25140, 25170, 25200, 25230, 25260, 25290, 25320, 25350, 25380, 25410,
                        25440, 25470, 25500, 25530, 25560, 25590, 25620, 25650, 25680, 25710, 25740, 25770, 25800,
                        25830, 25860, 25890, 25920, 25950, 25980, 26010, 26040, 26070, 26100, 26130, 26160, 26190,
                        26220, 26250, 26280, 26310, 26340, 26370, 26400, 26430, 26460, 26490, 26520, 26550, 26580,
                        26610, 26640, 26670, 26700, 26730, 26760, 26790, 26820, 26850, 26880, 26910, 26940, 26970,
                        27000, 27030, 27060, 27090, 27120, 27150, 27180, 27210, 27240, 27270, 27300, 27330, 27360,
                        27390, 27420, 27450, 27480, 27510, 27540, 27570],
        "mins_in_0": 25.5, "mins_in_1": 27.5, "mins_in_2": 270.5, "mins_in_3": 60.5, "mins_in_4": 73.0,
        "sleep_efficiency": 0.9442013129102844, "total_sleep_time": 431.5
    }

    assert (dict_out == correct_return)


def test_full_scorefile():
    dict_out = automated_parsing(filepath="testfiles/fulltype_scorefile.txt",
                                 fileformat="scorefile",
                                 filetype="Scoring",
                                 subjectid=2,
                                 visitid=1,
                                 sessionid=1,
                                 studyid="CAPStudy")

    correct_return = {
        "studyid": "CAPStudy",
        "subjectid": 2,
        "visitid": 1,
        "session": 1,
        "filetype": "Scoring",
        "fileformat": "scorefile",
        "epochstage": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, -1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 0, 1, 1, 1, 1, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, -1, -1, -1, -1, 0, 0, 0, 0, 1, 1, 2, 2, 2, 2, -1, 2, 2, 2, 2, 2,
                       2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 2, 2, 2, 2, 2, 2, 2, 0, 0, 1, 2, 0, 0, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, -1, -1, -1,
                       -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, -1, 2, 2, 2, 2, -1,
                       -1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 2, 2, -1,
                       -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                       -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0,
                       0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 3, 3, 3, 3, 2, 2, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0,
                       0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1,
                       1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                       -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                       -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 1, 1,
                       1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                       -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, -1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, -1, -1, -1, -1, -1, -1,
                       -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                       -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 2, 2, 2, 2, 0, 1, 1, 1, 1, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0],
        "epochoffset": [0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 330, 360, 390, 420, 450, 480, 510, 540, 570,
                        600, 630, 660, 690, 720, 750, 780, 810, 840, 870, 900, 930, 960, 990, 1020, 1050, 1080, 1110,
                        1140, 1170, 1200, 1230, 1260, 1290, 1320, 1350, 1380, 1410, 1440, 1470, 1500, 1530, 1560, 1590,
                        1620, 1650, 1680, 1710, 1740, 1770, 1800, 1830, 1860, 1890, 1920, 1950, 1980, 2010, 2040, 2070,
                        2100, 2130, 2160, 2190, 2220, 2250, 2280, 2310, 2340, 2370, 2400, 2430, 2460, 2490, 2520, 2550,
                        2580, 2610, 2640, 2670, 2700, 2730, 2760, 2790, 2820, 2850, 2880, 2910, 2940, 2970, 3000, 3030,
                        3060, 3090, 3120, 3150, 3180, 3210, 3240, 3270, 3300, 3330, 3360, 3390, 3420, 3450, 3480, 3510,
                        3540, 3570, 3600, 3630, 3660, 3690, 3720, 3750, 3780, 3810, 3840, 3870, 3900, 3930, 3960, 3990,
                        4020, 4050, 4080, 4110, 4140, 4170, 4200, 4230, 4260, 4290, 4320, 4350, 4380, 4410, 4440, 4470,
                        4500, 4530, 4560, 4590, 4620, 4650, 4680, 4710, 4740, 4770, 4800, 4830, 4860, 4890, 4920, 4950,
                        4980, 5010, 5040, 5070, 5100, 5130, 5160, 5190, 5220, 5250, 5280, 5310, 5340, 5370, 5400, 5430,
                        5460, 5490, 5520, 5550, 5580, 5610, 5640, 5670, 5700, 5730, 5760, 5790, 5820, 5850, 5880, 5910,
                        5940, 5970, 6000, 6030, 6060, 6090, 6120, 6150, 6180, 6210, 6240, 6270, 6300, 6330, 6360, 6390,
                        6420, 6450, 6480, 6510, 6540, 6570, 6600, 6630, 6660, 6690, 6720, 6750, 6780, 6810, 6840, 6870,
                        6900, 6930, 6960, 6990, 7020, 7050, 7080, 7110, 7140, 7170, 7200, 7230, 7260, 7290, 7320, 7350,
                        7380, 7410, 7440, 7470, 7500, 7530, 7560, 7590, 7620, 7650, 7680, 7710, 7740, 7770, 7800, 7830,
                        7860, 7890, 7920, 7950, 7980, 8010, 8040, 8070, 8100, 8130, 8160, 8190, 8220, 8250, 8280, 8310,
                        8340, 8370, 8400, 8430, 8460, 8490, 8520, 8550, 8580, 8610, 8640, 8670, 8700, 8730, 8760, 8790,
                        8820, 8850, 8880, 8910, 8940, 8970, 9000, 9030, 9060, 9090, 9120, 9150, 9180, 9210, 9240, 9270,
                        9300, 9330, 9360, 9390, 9420, 9450, 9480, 9510, 9540, 9570, 9600, 9630, 9660, 9690, 9720, 9750,
                        9780, 9810, 9840, 9870, 9900, 9930, 9960, 9990, 10020, 10050, 10080, 10110, 10140, 10170, 10200,
                        10230, 10260, 10290, 10320, 10350, 10380, 10410, 10440, 10470, 10500, 10530, 10560, 10590,
                        10620, 10650, 10680, 10710, 10740, 10770, 10800, 10830, 10860, 10890, 10920, 10950, 10980,
                        11010, 11040, 11070, 11100, 11130, 11160, 11190, 11220, 11250, 11280, 11310, 11340, 11370,
                        11400, 11430, 11460, 11490, 11520, 11550, 11580, 11610, 11640, 11670, 11700, 11730, 11760,
                        11790, 11820, 11850, 11880, 11910, 11940, 11970, 12000, 12030, 12060, 12090, 12120, 12150,
                        12180, 12210, 12240, 12270, 12300, 12330, 12360, 12390, 12420, 12450, 12480, 12510, 12540,
                        12570, 12600, 12630, 12660, 12690, 12720, 12750, 12780, 12810, 12840, 12870, 12900, 12930,
                        12960, 12990, 13020, 13050, 13080, 13110, 13140, 13170, 13200, 13230, 13260, 13290, 13320,
                        13350, 13380, 13410, 13440, 13470, 13500, 13530, 13560, 13590, 13620, 13650, 13680, 13710,
                        13740, 13770, 13800, 13830, 13860, 13890, 13920, 13950, 13980, 14010, 14040, 14070, 14100,
                        14130, 14160, 14190, 14220, 14250, 14280, 14310, 14340, 14370, 14400, 14430, 14460, 14490,
                        14520, 14550, 14580, 14610, 14640, 14670, 14700, 14730, 14760, 14790, 14820, 14850, 14880,
                        14910, 14940, 14970, 15000, 15030, 15060, 15090, 15120, 15150, 15180, 15210, 15240, 15270,
                        15300, 15330, 15360, 15390, 15420, 15450, 15480, 15510, 15540, 15570, 15600, 15630, 15660,
                        15690, 15720, 15750, 15780, 15810, 15840, 15870, 15900, 15930, 15960, 15990, 16020, 16050,
                        16080, 16110, 16140, 16170, 16200, 16230, 16260, 16290, 16320, 16350, 16380, 16410, 16440,
                        16470, 16500, 16530, 16560, 16590, 16620, 16650, 16680, 16710, 16740, 16770, 16800, 16830,
                        16860, 16890, 16920, 16950, 16980, 17010, 17040, 17070, 17100, 17130, 17160, 17190, 17220,
                        17250, 17280, 17310, 17340, 17370, 17400, 17430, 17460, 17490, 17520, 17550, 17580, 17610,
                        17640, 17670, 17700, 17730, 17760, 17790, 17820, 17850, 17880, 17910, 17940, 17970, 18000,
                        18030, 18060, 18090, 18120, 18150, 18180, 18210, 18240, 18270, 18300, 18330, 18360, 18390,
                        18420, 18450, 18480, 18510, 18540, 18570, 18600, 18630, 18660, 18690, 18720, 18750, 18780,
                        18810, 18840, 18870, 18900, 18930, 18960, 18990, 19020, 19050, 19080, 19110, 19140, 19170,
                        19200, 19230, 19260, 19290, 19320, 19350, 19380, 19410, 19440, 19470, 19500, 19530, 19560,
                        19590, 19620, 19650, 19680, 19710, 19740, 19770, 19800, 19830, 19860, 19890, 19920, 19950,
                        19980, 20010, 20040, 20070, 20100, 20130, 20160, 20190, 20220, 20250, 20280, 20310, 20340,
                        20370, 20400, 20430, 20460, 20490, 20520, 20550, 20580, 20610, 20640, 20670, 20700, 20730,
                        20760, 20790, 20820, 20850, 20880, 20910, 20940, 20970, 21000, 21030, 21060, 21090, 21120,
                        21150, 21180, 21210, 21240, 21270, 21300, 21330, 21360, 21390, 21420, 21450, 21480, 21510,
                        21540, 21570, 21600, 21630, 21660, 21690, 21720, 21750, 21780, 21810, 21840, 21870, 21900,
                        21930, 21960, 21990, 22020, 22050, 22080, 22110, 22140, 22170, 22200, 22230, 22260, 22290,
                        22320, 22350, 22380, 22410, 22440, 22470, 22500, 22530, 22560, 22590, 22620, 22650, 22680,
                        22710, 22740, 22770, 22800, 22830, 22860, 22890, 22920, 22950, 22980, 23010, 23040, 23070,
                        23100, 23130, 23160, 23190, 23220, 23250, 23280, 23310, 23340, 23370, 23400, 23430, 23460,
                        23490, 23520, 23550, 23580, 23610, 23640, 23670, 23700, 23730, 23760, 23790, 23820, 23850,
                        23880, 23910, 23940, 23970, 24000, 24030, 24060, 24090, 24120, 24150, 24180, 24210, 24240,
                        24270, 24300, 24330, 24360, 24390, 24420, 24450, 24480, 24510, 24540, 24570, 24600, 24630,
                        24660, 24690, 24720, 24750, 24780, 24810, 24840, 24870, 24900, 24930, 24960, 24990, 25020,
                        25050, 25080, 25110, 25140, 25170, 25200, 25230, 25260, 25290, 25320, 25350, 25380, 25410,
                        25440, 25470, 25500, 25530, 25560, 25590, 25620, 25650, 25680, 25710, 25740, 25770, 25800,
                        25830, 25860, 25890, 25920, 25950, 25980, 26010, 26040, 26070, 26100, 26130, 26160, 26190,
                        26220, 26250, 26280, 26310, 26340, 26370, 26400, 26430, 26460, 26490, 26520, 26550, 26580,
                        26610, 26640, 26670, 26700, 26730, 26760, 26790, 26820, 26850, 26880, 26910, 26940, 26970,
                        27000, 27030, 27060, 27090, 27120, 27150, 27180, 27210, 27240, 27270, 27300, 27330, 27360,
                        27390, 27420, 27450, 27480, 27510, 27540, 27570, 27600, 27630, 27660, 27690, 27720, 27750,
                        27780, 27810, 27840, 27870, 27900, 27930, 27960, 27990, 28020, 28050, 28080, 28110, 28140,
                        28170, 28200, 28230, 28260, 28290, 28320, 28350, 28380, 28410, 28440, 28470, 28500, 28530,
                        28560, 28590, 28620, 28650, 28680, 28710, 28740, 28770, 28800, 28830, 28860, 28890, 28920,
                        28950, 28980, 29010, 29040, 29070, 29100, 29130, 29160, 29190, 29220, 29250, 29280, 29310,
                        29340, 29370, 29400, 29430, 29460, 29490, 29520, 29550, 29580, 29610, 29640, 29670, 29700,
                        29730, 29760, 29790, 29820, 29850, 29880, 29910, 29940, 29970, 30000, 30030, 30060, 30090,
                        30120, 30150, 30180, 30210, 30240, 30270, 30300, 30330, 30360, 30390, 30420, 30450, 30480,
                        30510, 30540, 30570, 30600, 30630, 30660, 30690, 30720, 30750, 30780, 30810, 30840, 30870,
                        30900],
        "startime": datetime.datetime(2010, 1, 28, 22, 18, 17),
        "mins_in_0": 53.0, "mins_in_1": 45.5, "mins_in_2": 241.0, "mins_in_3": 83.5,
        "sleep_efficiency": 0.8747044917257684, "total_sleep_time": 370.0
    }

    assert (dict_out == correct_return)


def test_XML_scorefile():
    dict_out = automated_parsing(filepath="testfiles/xmltype_scorefile.xml",
                                 fileformat="scorefile",
                                 filetype="Scoring",
                                 subjectid=2,
                                 visitid=1,
                                 sessionid=1,
                                 studyid="NSRR")

    correct_return = {
        "studyid": "NSRR",
        "subjectid": 2,
        "visitid": 1,
        "session": 1,
        "filetype": "Scoring",
        "fileformat": "scorefile",
        "epochstage": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 1, 2,
                       2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 4, 4, 4, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0,
                       0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 3, 3, 3,
                       2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 4, 4, 4, 4, 4, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 2, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 3, 2,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 1, 4, 4, 4, 4, 4,
                       4, 4, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 1, 0, 4, 4, 4, 4, 4, 1, 4, 4, 0, 0, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 1, 2, 2, 2, 2, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 4, 4, 4, 4, 4, 4,
                       4, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0,
                       1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 0, 1, 4, 4, 0, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
        "epochoffset": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0, 390.0,
                        420.0, 450.0, 480.0, 510.0, 540.0, 570.0, 600.0, 630.0, 660.0, 690.0, 720.0, 750.0, 780.0,
                        810.0, 840.0, 870.0, 900.0, 930.0, 960.0, 990.0, 1020.0, 1050.0, 1080.0, 1110.0, 1140.0, 1170.0,
                        1200.0, 1230.0, 1260.0, 1290.0, 1320.0, 1350.0, 1380.0, 1410.0, 1440.0, 1470.0, 1500.0, 1530.0,
                        1560.0, 1590.0, 1620.0, 1650.0, 1680.0, 1710.0, 1740.0, 1770.0, 1800.0, 1830.0, 1860.0, 1890.0,
                        1920.0, 1950.0, 1980.0, 2010.0, 2040.0, 2070.0, 2100.0, 2130.0, 2160.0, 2190.0, 2220.0, 2250.0,
                        2280.0, 2310.0, 2340.0, 2370.0, 2400.0, 2430.0, 2460.0, 2490.0, 2520.0, 2550.0, 2580.0, 2610.0,
                        2640.0, 2670.0, 2700.0, 2730.0, 2760.0, 2790.0, 2820.0, 2850.0, 2880.0, 2910.0, 2940.0, 2970.0,
                        3000.0, 3030.0, 3060.0, 3090.0, 3120.0, 3150.0, 3180.0, 3210.0, 3240.0, 3270.0, 3300.0, 3330.0,
                        3360.0, 3390.0, 3420.0, 3450.0, 3480.0, 3510.0, 3540.0, 3570.0, 3600.0, 3630.0, 3660.0, 3690.0,
                        3720.0, 3750.0, 3780.0, 3810.0, 3840.0, 3870.0, 3900.0, 3930.0, 3960.0, 3990.0, 4020.0, 4050.0,
                        4080.0, 4110.0, 4140.0, 4170.0, 4200.0, 4230.0, 4260.0, 4290.0, 4320.0, 4350.0, 4380.0, 4410.0,
                        4440.0, 4470.0, 4500.0, 4530.0, 4560.0, 4590.0, 4620.0, 4650.0, 4680.0, 4710.0, 4740.0, 4770.0,
                        4800.0, 4830.0, 4860.0, 4890.0, 4920.0, 4950.0, 4980.0, 5010.0, 5040.0, 5070.0, 5100.0, 5130.0,
                        5160.0, 5190.0, 5220.0, 5250.0, 5280.0, 5310.0, 5340.0, 5370.0, 5400.0, 5430.0, 5460.0, 5490.0,
                        5520.0, 5550.0, 5580.0, 5610.0, 5640.0, 5670.0, 5700.0, 5730.0, 5760.0, 5790.0, 5820.0, 5850.0,
                        5880.0, 5910.0, 5940.0, 5970.0, 6000.0, 6030.0, 6060.0, 6090.0, 6120.0, 6150.0, 6180.0, 6210.0,
                        6240.0, 6270.0, 6300.0, 6330.0, 6360.0, 6390.0, 6420.0, 6450.0, 6480.0, 6510.0, 6540.0, 6570.0,
                        6600.0, 6630.0, 6660.0, 6690.0, 6720.0, 6750.0, 6780.0, 6810.0, 6840.0, 6870.0, 6900.0, 6930.0,
                        6960.0, 6990.0, 7020.0, 7050.0, 7080.0, 7110.0, 7140.0, 7170.0, 7200.0, 7230.0, 7260.0, 7290.0,
                        7320.0, 7350.0, 7380.0, 7410.0, 7440.0, 7470.0, 7500.0, 7530.0, 7560.0, 7590.0, 7620.0, 7650.0,
                        7680.0, 7710.0, 7740.0, 7770.0, 7800.0, 7830.0, 7860.0, 7890.0, 7920.0, 7950.0, 7980.0, 8010.0,
                        8040.0, 8070.0, 8100.0, 8130.0, 8160.0, 8190.0, 8220.0, 8250.0, 8280.0, 8310.0, 8340.0, 8370.0,
                        8400.0, 8430.0, 8460.0, 8490.0, 8520.0, 8550.0, 8580.0, 8610.0, 8640.0, 8670.0, 8700.0, 8730.0,
                        8760.0, 8790.0, 8820.0, 8850.0, 8880.0, 8910.0, 8940.0, 8970.0, 9000.0, 9030.0, 9060.0, 9090.0,
                        9120.0, 9150.0, 9180.0, 9210.0, 9240.0, 9270.0, 9300.0, 9330.0, 9360.0, 9390.0, 9420.0, 9450.0,
                        9480.0, 9510.0, 9540.0, 9570.0, 9600.0, 9630.0, 9660.0, 9690.0, 9720.0, 9750.0, 9780.0, 9810.0,
                        9840.0, 9870.0, 9900.0, 9930.0, 9960.0, 9990.0, 10020.0, 10050.0, 10080.0, 10110.0, 10140.0,
                        10170.0, 10200.0, 10230.0, 10260.0, 10290.0, 10320.0, 10350.0, 10380.0, 10410.0, 10440.0,
                        10470.0, 10500.0, 10530.0, 10560.0, 10590.0, 10620.0, 10650.0, 10680.0, 10710.0, 10740.0,
                        10770.0, 10800.0, 10830.0, 10860.0, 10890.0, 10920.0, 10950.0, 10980.0, 11010.0, 11040.0,
                        11070.0, 11100.0, 11130.0, 11160.0, 11190.0, 11220.0, 11250.0, 11280.0, 11310.0, 11340.0,
                        11370.0, 11400.0, 11430.0, 11460.0, 11490.0, 11520.0, 11550.0, 11580.0, 11610.0, 11640.0,
                        11670.0, 11700.0, 11730.0, 11760.0, 11790.0, 11820.0, 11850.0, 11880.0, 11910.0, 11940.0,
                        11970.0, 12000.0, 12030.0, 12060.0, 12090.0, 12120.0, 12150.0, 12180.0, 12210.0, 12240.0,
                        12270.0, 12300.0, 12330.0, 12360.0, 12390.0, 12420.0, 12450.0, 12480.0, 12510.0, 12540.0,
                        12570.0, 12600.0, 12630.0, 12660.0, 12690.0, 12720.0, 12750.0, 12780.0, 12810.0, 12840.0,
                        12870.0, 12900.0, 12930.0, 12960.0, 12990.0, 13020.0, 13050.0, 13080.0, 13110.0, 13140.0,
                        13170.0, 13200.0, 13230.0, 13260.0, 13290.0, 13320.0, 13350.0, 13380.0, 13410.0, 13440.0,
                        13470.0, 13500.0, 13530.0, 13560.0, 13590.0, 13620.0, 13650.0, 13680.0, 13710.0, 13740.0,
                        13770.0, 13800.0, 13830.0, 13860.0, 13890.0, 13920.0, 13950.0, 13980.0, 14010.0, 14040.0,
                        14070.0, 14100.0, 14130.0, 14160.0, 14190.0, 14220.0, 14250.0, 14280.0, 14310.0, 14340.0,
                        14370.0, 14400.0, 14430.0, 14460.0, 14490.0, 14520.0, 14550.0, 14580.0, 14610.0, 14640.0,
                        14670.0, 14700.0, 14730.0, 14760.0, 14790.0, 14820.0, 14850.0, 14880.0, 14910.0, 14940.0,
                        14970.0, 15000.0, 15030.0, 15060.0, 15090.0, 15120.0, 15150.0, 15180.0, 15210.0, 15240.0,
                        15270.0, 15300.0, 15330.0, 15360.0, 15390.0, 15420.0, 15450.0, 15480.0, 15510.0, 15540.0,
                        15570.0, 15600.0, 15630.0, 15660.0, 15690.0, 15720.0, 15750.0, 15780.0, 15810.0, 15840.0,
                        15870.0, 15900.0, 15930.0, 15960.0, 15990.0, 16020.0, 16050.0, 16080.0, 16110.0, 16140.0,
                        16170.0, 16200.0, 16230.0, 16260.0, 16290.0, 16320.0, 16350.0, 16380.0, 16410.0, 16440.0,
                        16470.0, 16500.0, 16530.0, 16560.0, 16590.0, 16620.0, 16650.0, 16680.0, 16710.0, 16740.0,
                        16770.0, 16800.0, 16830.0, 16860.0, 16890.0, 16920.0, 16950.0, 16980.0, 17010.0, 17040.0,
                        17070.0, 17100.0, 17130.0, 17160.0, 17190.0, 17220.0, 17250.0, 17280.0, 17310.0, 17340.0,
                        17370.0, 17400.0, 17430.0, 17460.0, 17490.0, 17520.0, 17550.0, 17580.0, 17610.0, 17640.0,
                        17670.0, 17700.0, 17730.0, 17760.0, 17790.0, 17820.0, 17850.0, 17880.0, 17910.0, 17940.0,
                        17970.0, 18000.0, 18030.0, 18060.0, 18090.0, 18120.0, 18150.0, 18180.0, 18210.0, 18240.0,
                        18270.0, 18300.0, 18330.0, 18360.0, 18390.0, 18420.0, 18450.0, 18480.0, 18510.0, 18540.0,
                        18570.0, 18600.0, 18630.0, 18660.0, 18690.0, 18720.0, 18750.0, 18780.0, 18810.0, 18840.0,
                        18870.0, 18900.0, 18930.0, 18960.0, 18990.0, 19020.0, 19050.0, 19080.0, 19110.0, 19140.0,
                        19170.0, 19200.0, 19230.0, 19260.0, 19290.0, 19320.0, 19350.0, 19380.0, 19410.0, 19440.0,
                        19470.0, 19500.0, 19530.0, 19560.0, 19590.0, 19620.0, 19650.0, 19680.0, 19710.0, 19740.0,
                        19770.0, 19800.0, 19830.0, 19860.0, 19890.0, 19920.0, 19950.0, 19980.0, 20010.0, 20040.0,
                        20070.0, 20100.0, 20130.0, 20160.0, 20190.0, 20220.0, 20250.0, 20280.0, 20310.0, 20340.0,
                        20370.0, 20400.0, 20430.0, 20460.0, 20490.0, 20520.0, 20550.0, 20580.0, 20610.0, 20640.0,
                        20670.0, 20700.0, 20730.0, 20760.0, 20790.0, 20820.0, 20850.0, 20880.0, 20910.0, 20940.0,
                        20970.0, 21000.0, 21030.0, 21060.0, 21090.0, 21120.0, 21150.0, 21180.0, 21210.0, 21240.0,
                        21270.0, 21300.0, 21330.0, 21360.0, 21390.0, 21420.0, 21450.0, 21480.0, 21510.0, 21540.0,
                        21570.0, 21600.0, 21630.0, 21660.0, 21690.0, 21720.0, 21750.0, 21780.0, 21810.0, 21840.0,
                        21870.0, 21900.0, 21930.0, 21960.0, 21990.0, 22020.0, 22050.0, 22080.0, 22110.0, 22140.0,
                        22170.0, 22200.0, 22230.0, 22260.0, 22290.0, 22320.0, 22350.0, 22380.0, 22410.0, 22440.0,
                        22470.0, 22500.0, 22530.0, 22560.0, 22590.0, 22620.0, 22650.0, 22680.0, 22710.0, 22740.0,
                        22770.0, 22800.0, 22830.0, 22860.0, 22890.0, 22920.0, 22950.0, 22980.0, 23010.0, 23040.0,
                        23070.0, 23100.0, 23130.0, 23160.0, 23190.0, 23220.0, 23250.0, 23280.0, 23310.0, 23340.0,
                        23370.0, 23400.0, 23430.0, 23460.0, 23490.0, 23520.0, 23550.0, 23580.0, 23610.0, 23640.0,
                        23670.0, 23700.0, 23730.0, 23760.0, 23790.0, 23820.0, 23850.0, 23880.0, 23910.0, 23940.0,
                        23970.0, 24000.0, 24030.0, 24060.0, 24090.0, 24120.0, 24150.0, 24180.0, 24210.0, 24240.0,
                        24270.0, 24300.0, 24330.0, 24360.0, 24390.0, 24420.0, 24450.0, 24480.0, 24510.0, 24540.0,
                        24570.0, 24600.0, 24630.0, 24660.0, 24690.0, 24720.0, 24750.0, 24780.0, 24810.0, 24840.0,
                        24870.0, 24900.0, 24930.0, 24960.0, 24990.0, 25020.0, 25050.0, 25080.0, 25110.0, 25140.0,
                        25170.0, 25200.0, 25230.0, 25260.0, 25290.0, 25320.0, 25350.0, 25380.0, 25410.0, 25440.0,
                        25470.0, 25500.0, 25530.0, 25560.0, 25590.0, 25620.0, 25650.0, 25680.0, 25710.0, 25740.0,
                        25770.0, 25800.0, 25830.0, 25860.0, 25890.0, 25920.0, 25950.0, 25980.0, 26010.0, 26040.0,
                        26070.0, 26100.0, 26130.0, 26160.0, 26190.0, 26220.0, 26250.0, 26280.0, 26310.0, 26340.0,
                        26370.0, 26400.0, 26430.0, 26460.0, 26490.0, 26520.0, 26550.0, 26580.0, 26610.0, 26640.0,
                        26670.0, 26700.0, 26730.0, 26760.0, 26790.0, 26820.0, 26850.0, 26880.0, 26910.0, 26940.0,
                        26970.0, 27000.0, 27030.0, 27060.0, 27090.0, 27120.0, 27150.0, 27180.0, 27210.0, 27240.0,
                        27270.0, 27300.0, 27330.0, 27360.0, 27390.0, 27420.0, 27450.0, 27480.0, 27510.0, 27540.0,
                        27570.0, 27600.0, 27630.0, 27660.0, 27690.0, 27720.0, 27750.0, 27780.0, 27810.0, 27840.0,
                        27870.0, 27900.0, 27930.0, 27960.0, 27990.0, 28020.0, 28050.0, 28080.0, 28110.0, 28140.0,
                        28170.0, 28200.0, 28230.0, 28260.0, 28290.0, 28320.0, 28350.0, 28380.0, 28410.0, 28440.0,
                        28470.0, 28500.0, 28530.0, 28560.0, 28590.0, 28620.0, 28650.0, 28680.0, 28710.0, 28740.0,
                        28770.0, 28800.0, 28830.0, 28860.0, 28890.0, 28920.0, 28950.0, 28980.0, 29010.0, 29040.0,
                        29070.0, 29100.0, 29130.0, 29160.0, 29190.0, 29220.0, 29250.0, 29280.0, 29310.0, 29340.0,
                        29370.0, 29400.0, 29430.0, 29460.0, 29490.0, 29520.0, 29550.0, 29580.0, 29610.0, 29640.0,
                        29670.0, 29700.0, 29730.0, 29760.0, 29790.0, 29820.0, 29850.0, 29880.0, 29910.0, 29940.0,
                        29970.0, 30000.0, 30030.0, 30060.0, 30090.0, 30120.0, 30150.0, 30180.0, 30210.0, 30240.0,
                        30270.0, 30300.0, 30330.0, 30360.0, 30390.0, 30420.0, 30450.0, 30480.0, 30510.0, 30540.0,
                        30570.0, 30600.0, 30630.0, 30660.0, 30690.0, 30720.0, 30750.0, 30780.0, 30810.0, 30840.0,
                        30870.0, 30900.0, 30930.0, 30960.0, 30990.0, 31020.0, 31050.0, 31080.0, 31110.0, 31140.0,
                        31170.0, 31200.0, 31230.0, 31260.0, 31290.0, 31320.0, 31350.0, 31380.0, 31410.0, 31440.0,
                        31470.0, 31500.0, 31530.0, 31560.0, 31590.0, 31620.0, 31650.0, 31680.0, 31710.0, 31740.0,
                        31770.0, 31800.0, 31830.0, 31860.0, 31890.0, 31920.0, 31950.0, 31980.0, 32010.0, 32040.0,
                        32070.0, 32100.0, 32130.0, 32160.0, 32190.0, 32220.0, 32250.0, 32280.0, 32310.0, 32340.0,
                        32370.0, 32400.0, 32430.0, 32460.0, 32490.0, 32520.0, 32550.0, 32580.0, 32610.0, 32640.0,
                        32670.0, 32700.0, 32730.0, 32760.0, 32790.0, 32820.0, 32850.0, 32880.0, 32910.0, 32940.0,
                        32970.0, 33000.0, 33030.0, 33060.0, 33090.0, 33120.0, 33150.0, 33180.0, 33210.0, 33240.0,
                        33270.0, 33300.0, 33330.0, 33360.0, 33390.0, 33420.0, 33450.0, 33480.0, 33510.0, 33540.0,
                        33570.0, 33600.0, 33630.0, 33660.0, 33690.0, 33720.0, 33750.0, 33780.0, 33810.0, 33840.0,
                        33870.0, 33900.0, 33930.0, 33960.0, 33990.0, 34020.0, 34050.0, 34080.0, 34110.0, 34140.0,
                        34170.0, 34200.0, 34230.0, 34260.0, 34290.0, 34320.0, 34350.0, 34380.0, 34410.0, 34440.0,
                        34470.0, 34500.0, 34530.0, 34560.0, 34590.0, 34620.0, 34650.0, 34680.0, 34710.0, 34740.0,
                        34770.0, 34800.0, 34830.0, 34860.0, 34890.0, 34920.0, 34950.0, 34980.0, 35010.0, 35040.0,
                        35070.0, 35100.0, 35130.0, 35160.0, 35190.0, 35220.0, 35250.0, 35280.0, 35310.0, 35340.0,
                        35370.0, 35400.0, 35430.0, 35460.0, 35490.0, 35520.0, 35550.0, 35580.0, 35610.0, 35640.0,
                        35670.0, 35700.0, 35730.0, 35760.0, 35790.0, 35820.0, 35850.0, 35880.0, 35910.0, 35940.0,
                        35970.0, 36000.0, 36030.0, 36060.0, 36090.0, 36120.0, 36150.0, 36180.0, 36210.0, 36240.0,
                        36270.0, 36300.0, 36330.0, 36360.0, 36390.0, 36420.0, 36450.0, 36480.0, 36510.0, 36540.0,
                        36570.0, 36600.0, 36630.0, 36660.0, 36690.0, 36720.0, 36750.0, 36780.0, 36810.0, 36840.0,
                        36870.0, 36900.0, 36930.0, 36960.0, 36990.0, 37020.0, 37050.0, 37080.0, 37110.0, 37140.0,
                        37170.0, 37200.0, 37230.0, 37260.0, 37290.0, 37320.0, 37350.0, 37380.0, 37410.0, 37440.0,
                        37470.0, 37500.0, 37530.0, 37560.0, 37590.0, 37620.0, 37650.0, 37680.0, 37710.0, 37740.0,
                        37770.0, 37800.0, 37830.0, 37860.0, 37890.0, 37920.0, 37950.0, 37980.0, 38010.0, 38040.0,
                        38070.0, 38100.0, 38130.0, 38160.0, 38190.0, 38220.0, 38250.0, 38280.0, 38310.0, 38340.0,
                        38370.0, 38400.0, 38430.0, 38460.0, 38490.0, 38520.0, 38550.0, 38580.0, 38610.0, 38640.0,
                        38670.0, 38700.0, 38730.0, 38760.0, 38790.0, 38820.0, 38850.0, 38880.0, 38910.0, 38940.0,
                        38970.0, 39000.0, 39030.0, 39060.0, 39090.0, 39120.0, 39150.0, 39180.0, 39210.0, 39240.0,
                        39270.0, 39300.0, 39330.0, 39360.0, 39390.0, 39420.0, 39450.0, 39480.0, 39510.0, 39540.0,
                        39570.0, 39600.0, 39630.0, 39660.0, 39690.0, 39720.0, 39750.0, 39780.0, 39810.0, 39840.0,
                        39870.0, 39900.0, 39930.0, 39960.0, 39990.0, 40020.0, 40050.0, 40080.0, 40110.0, 40140.0,
                        40170.0, 40200.0, 40230.0, 40260.0, 40290.0, 40320.0, 40350.0, 40380.0, 40410.0, 40440.0,
                        40470.0, 40500.0, 40530.0, 40560.0, 40590.0, 40620.0, 40650.0, 40680.0, 40710.0, 40740.0,
                        40770.0, 40800.0, 40830.0, 40860.0, 40890.0, 40920.0, 40950.0, 40980.0, 41010.0, 41040.0,
                        41070.0, 41100.0, 41130.0],
        "starttime": datetime.datetime(1900, 1, 1, 20, 33, 32),
        "mins_in_0": 196.0, "mins_in_1": 18.5, "mins_in_2": 209.5, "mins_in_3": 141.0, "mins_in_4": 121.0,
        "sleep_efficiency": 0.7142857142857143, "total_sleep_time": 490.0
    }

    assert (dict_out == correct_return)


def test_edf1_scorefile():
    dict_out = automated_parsing(filepath="testfiles/edftype1_scorefile.edf",
                                 fileformat="scorefile",
                                 filetype="Scoring",
                                 subjectid=2,
                                 visitid=1,
                                 sessionid=1,
                                 studyid="WamsleyLab")
    correct_return = {
        "studyid": "WamsleyLab",
        "subjectid": 2,
        "visitid": 1,
        "session": 1,
        "filetype": "Scoring",
        "fileformat": "scorefile",
        "epochstage": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1,
                       1, 0, 0, 1, 1, 1, 1, 1, 2, 0, 0, 0, 1, 2, 2, 2, 0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 0, 0, 0, 0, 0, 0,
                       0, 1, 1, 1, 2, 2, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 0, 0, 0, 1, 1, 2, 2, 2, 2, 0, 1, 1, 1, 1, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1,
                       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 2, 2, 2, 4, 4, 2, 4, 4, 2,
                       4, 4, 4, 4, 4, 4, 4, 4, 2, 4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 2, 2,
                       2, 2, 2, 2, 2, 4, 4, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 3, 3, 3, 2, 3, 3, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2, 2, 2, 2, 0, 0, 1,
                       1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2, 0,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 0, 1, 1, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2],
        "epochoffset": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0, 390.0,
                        420.0, 450.0, 480.0, 510.0, 540.0, 570.0, 600.0, 630.0, 660.0, 690.0, 720.0, 750.0, 780.0,
                        810.0, 840.0, 870.0, 900.0, 930.0, 960.0, 990.0, 1020.0, 1050.0, 1080.0, 1110.0, 1140.0, 1170.0,
                        1200.0, 1230.0, 1260.0, 1290.0, 1320.0, 1350.0, 1380.0, 1410.0, 1440.0, 1470.0, 1500.0, 1530.0,
                        1560.0, 1590.0, 1620.0, 1650.0, 1680.0, 1710.0, 1740.0, 1770.0, 1800.0, 1830.0, 1860.0, 1890.0,
                        1920.0, 1950.0, 1980.0, 2010.0, 2040.0, 2070.0, 2100.0, 2130.0, 2160.0, 2190.0, 2220.0, 2250.0,
                        2280.0, 2310.0, 2340.0, 2370.0, 2400.0, 2430.0, 2460.0, 2490.0, 2520.0, 2550.0, 2580.0, 2610.0,
                        2640.0, 2670.0, 2700.0, 2730.0, 2760.0, 2790.0, 2820.0, 2850.0, 2880.0, 2910.0, 2940.0, 2970.0,
                        3000.0, 3030.0, 3060.0, 3090.0, 3120.0, 3150.0, 3180.0, 3210.0, 3240.0, 3270.0, 3300.0, 3330.0,
                        3360.0, 3390.0, 3420.0, 3450.0, 3480.0, 3510.0, 3540.0, 3570.0, 3600.0, 3630.0, 3660.0, 3690.0,
                        3720.0, 3750.0, 3780.0, 3810.0, 3840.0, 3870.0, 3900.0, 3930.0, 3960.0, 3990.0, 4020.0, 4050.0,
                        4080.0, 4110.0, 4140.0, 4170.0, 4200.0, 4230.0, 4260.0, 4290.0, 4320.0, 4350.0, 4380.0, 4410.0,
                        4440.0, 4470.0, 4500.0, 4530.0, 4560.0, 4590.0, 4620.0, 4650.0, 4680.0, 4710.0, 4740.0, 4770.0,
                        4800.0, 4830.0, 4860.0, 4890.0, 4920.0, 4950.0, 4980.0, 5010.0, 5040.0, 5070.0, 5100.0, 5130.0,
                        5160.0, 5190.0, 5220.0, 5250.0, 5280.0, 5310.0, 5340.0, 5370.0, 5400.0, 5430.0, 5460.0, 5490.0,
                        5520.0, 5550.0, 5580.0, 5610.0, 5640.0, 5670.0, 5700.0, 5730.0, 5760.0, 5790.0, 5820.0, 5850.0,
                        5880.0, 5910.0, 5940.0, 5970.0, 6000.0, 6030.0, 6060.0, 6090.0, 6120.0, 6150.0, 6180.0, 6210.0,
                        6240.0, 6270.0, 6300.0, 6330.0, 6360.0, 6390.0, 6420.0, 6450.0, 6480.0, 6510.0, 6540.0, 6570.0,
                        6600.0, 6630.0, 6660.0, 6690.0, 6720.0, 6750.0, 6780.0, 6810.0, 6840.0, 6870.0, 6900.0, 6930.0,
                        6960.0, 6990.0, 7020.0, 7050.0, 7080.0, 7110.0, 7140.0, 7170.0, 7200.0, 7230.0, 7260.0, 7290.0,
                        7320.0, 7350.0, 7380.0, 7410.0, 7440.0, 7470.0, 7500.0, 7530.0, 7560.0, 7590.0, 7620.0, 7650.0,
                        7680.0, 7710.0, 7740.0, 7770.0, 7800.0, 7830.0, 7860.0, 7890.0, 7920.0, 7950.0, 7980.0, 8010.0,
                        8040.0, 8070.0, 8100.0, 8130.0, 8160.0, 8190.0, 8220.0, 8250.0, 8280.0, 8310.0, 8340.0, 8370.0,
                        8400.0, 8430.0, 8460.0, 8490.0, 8520.0, 8550.0, 8580.0, 8610.0, 8640.0, 8670.0, 8700.0, 8730.0,
                        8760.0, 8790.0, 8820.0, 8850.0, 8880.0, 8910.0, 8940.0, 8970.0, 9000.0, 9030.0, 9060.0, 9090.0,
                        9120.0, 9150.0, 9180.0, 9210.0, 9240.0, 9270.0, 9300.0, 9330.0, 9360.0, 9390.0, 9420.0, 9450.0,
                        9480.0, 9510.0, 9540.0, 9570.0, 9600.0, 9630.0, 9660.0, 9690.0, 9720.0, 9750.0, 9780.0, 9810.0,
                        9840.0, 9870.0, 9900.0, 9930.0, 9960.0, 9990.0, 10020.0, 10050.0, 10080.0, 10110.0, 10140.0,
                        10170.0, 10200.0, 10230.0, 10260.0, 10290.0, 10320.0, 10350.0, 10380.0, 10410.0, 10440.0,
                        10470.0, 10500.0, 10530.0, 10560.0, 10590.0, 10620.0, 10650.0, 10680.0, 10710.0, 10740.0,
                        10770.0, 10800.0, 10830.0, 10860.0, 10890.0, 10920.0, 10950.0, 10980.0, 11010.0, 11040.0,
                        11070.0, 11100.0, 11130.0, 11160.0, 11190.0, 11220.0, 11250.0, 11280.0, 11310.0, 11340.0,
                        11370.0, 11400.0, 11430.0, 11460.0, 11490.0, 11520.0, 11550.0, 11580.0, 11610.0, 11640.0,
                        11670.0, 11700.0, 11730.0, 11760.0, 11790.0, 11820.0, 11850.0, 11880.0, 11910.0, 11940.0,
                        11970.0, 12000.0, 12030.0, 12060.0, 12090.0, 12120.0, 12150.0, 12180.0, 12210.0, 12240.0,
                        12270.0, 12300.0, 12330.0, 12360.0, 12390.0, 12420.0, 12450.0, 12480.0, 12510.0, 12540.0,
                        12570.0, 12600.0, 12630.0, 12660.0, 12690.0, 12720.0, 12750.0, 12780.0, 12810.0, 12840.0,
                        12870.0, 12900.0, 12930.0, 12960.0, 12990.0, 13020.0, 13050.0, 13080.0, 13110.0, 13140.0,
                        13170.0, 13200.0, 13230.0, 13260.0, 13290.0, 13320.0, 13350.0, 13380.0, 13410.0, 13440.0,
                        13470.0, 13500.0, 13530.0, 13560.0, 13590.0, 13620.0, 13650.0, 13680.0, 13710.0, 13740.0,
                        13770.0, 13800.0, 13830.0, 13860.0, 13890.0, 13920.0, 13950.0, 13980.0, 14010.0, 14040.0,
                        14070.0, 14100.0, 14130.0, 14160.0, 14190.0, 14220.0, 14250.0, 14280.0, 14310.0, 14340.0,
                        14370.0, 14400.0, 14430.0, 14460.0, 14490.0, 14520.0, 14550.0, 14580.0, 14610.0, 14640.0,
                        14670.0, 14700.0, 14730.0, 14760.0, 14790.0, 14820.0, 14850.0, 14880.0, 14910.0, 14940.0,
                        14970.0, 15000.0, 15030.0, 15060.0, 15090.0, 15120.0, 15150.0, 15180.0, 15210.0, 15240.0,
                        15270.0, 15300.0, 15330.0, 15360.0, 15390.0, 15420.0, 15450.0, 15480.0, 15510.0, 15540.0,
                        15570.0, 15600.0, 15630.0, 15660.0, 15690.0, 15720.0, 15750.0, 15780.0, 15810.0, 15840.0,
                        15870.0, 15900.0, 15930.0, 15960.0, 15990.0, 16020.0, 16050.0, 16080.0, 16110.0, 16140.0,
                        16170.0, 16200.0, 16230.0, 16260.0, 16290.0, 16320.0, 16350.0, 16380.0, 16410.0, 16440.0,
                        16470.0, 16500.0, 16530.0, 16560.0, 16590.0, 16620.0, 16650.0, 16680.0, 16710.0, 16740.0,
                        16770.0, 16800.0, 16830.0, 16860.0, 16890.0, 16920.0, 16950.0, 16980.0, 17010.0, 17040.0,
                        17070.0, 17100.0, 17130.0, 17160.0, 17190.0, 17220.0, 17250.0, 17280.0, 17310.0, 17340.0,
                        17370.0, 17400.0, 17430.0, 17460.0, 17490.0, 17520.0, 17550.0, 17580.0, 17610.0, 17640.0,
                        17670.0, 17700.0, 17730.0, 17760.0, 17790.0, 17820.0, 17850.0, 17880.0, 17910.0, 17940.0,
                        17970.0, 18000.0, 18030.0, 18060.0, 18090.0, 18120.0, 18150.0, 18180.0, 18210.0, 18240.0,
                        18270.0, 18300.0, 18330.0, 18360.0, 18390.0, 18420.0, 18450.0, 18480.0, 18510.0, 18540.0,
                        18570.0, 18600.0, 18630.0, 18660.0, 18690.0, 18720.0, 18750.0, 18780.0, 18810.0, 18840.0,
                        18870.0, 18900.0, 18930.0, 18960.0, 18990.0, 19020.0, 19050.0, 19080.0, 19110.0, 19140.0,
                        19170.0, 19200.0, 19230.0, 19260.0, 19290.0, 19320.0, 19350.0, 19380.0, 19410.0, 19440.0,
                        19470.0, 19500.0, 19530.0, 19560.0, 19590.0, 19620.0, 19650.0, 19680.0, 19710.0, 19740.0,
                        19770.0, 19800.0, 19830.0, 19860.0, 19890.0, 19920.0, 19950.0, 19980.0, 20010.0, 20040.0,
                        20070.0, 20100.0, 20130.0, 20160.0, 20190.0, 20220.0, 20250.0, 20280.0, 20310.0, 20340.0,
                        20370.0, 20400.0, 20430.0, 20460.0, 20490.0, 20520.0, 20550.0, 20580.0, 20610.0, 20640.0,
                        20670.0, 20700.0, 20730.0, 20760.0, 20790.0, 20820.0, 20850.0, 20880.0, 20910.0, 20940.0,
                        20970.0, 21000.0, 21030.0, 21060.0, 21090.0, 21120.0, 21150.0, 21180.0, 21210.0, 21240.0,
                        21270.0, 21300.0, 21330.0, 21360.0, 21390.0, 21420.0, 21450.0, 21480.0, 21510.0, 21540.0,
                        21570.0, 21600.0, 21630.0, 21660.0, 21690.0, 21720.0, 21750.0, 21780.0, 21810.0, 21840.0,
                        21870.0, 21900.0, 21930.0, 21960.0, 21990.0, 22020.0, 22050.0, 22080.0, 22110.0, 22140.0,
                        22170.0, 22200.0, 22230.0, 22260.0, 22290.0, 22320.0, 22350.0, 22380.0, 22410.0, 22440.0,
                        22470.0, 22500.0, 22530.0, 22560.0, 22590.0, 22620.0, 22650.0, 22680.0, 22710.0, 22740.0,
                        22770.0, 22800.0, 22830.0, 22860.0, 22890.0, 22920.0, 22950.0, 22980.0, 23010.0, 23040.0,
                        23070.0, 23100.0, 23130.0, 23160.0, 23190.0, 23220.0, 23250.0, 23280.0, 23310.0, 23340.0,
                        23370.0, 23400.0, 23430.0, 23460.0, 23490.0, 23520.0, 23550.0, 23580.0, 23610.0, 23640.0,
                        23670.0, 23700.0, 23730.0, 23760.0, 23790.0, 23820.0, 23850.0, 23880.0, 23910.0, 23940.0,
                        23970.0, 24000.0, 24030.0, 24060.0, 24090.0, 24120.0, 24150.0, 24180.0, 24210.0, 24240.0,
                        24270.0, 24300.0, 24330.0, 24360.0, 24390.0, 24420.0, 24450.0, 24480.0, 24510.0, 24540.0,
                        24570.0, 24600.0, 24630.0, 24660.0, 24690.0, 24720.0, 24750.0, 24780.0, 24810.0, 24840.0,
                        24870.0, 24900.0, 24930.0, 24960.0, 24990.0, 25020.0, 25050.0, 25080.0, 25110.0, 25140.0,
                        25170.0, 25200.0, 25230.0, 25260.0, 25290.0, 25320.0, 25350.0, 25380.0, 25410.0, 25440.0,
                        25470.0, 25500.0, 25530.0, 25560.0, 25590.0, 25620.0, 25650.0, 25680.0, 25710.0, 25740.0,
                        25770.0, 25800.0, 25830.0, 25860.0, 25890.0, 25920.0, 25950.0, 25980.0, 26010.0, 26040.0,
                        26070.0, 26100.0, 26130.0, 26160.0, 26190.0, 26220.0, 26250.0, 26280.0, 26310.0, 26340.0,
                        26370.0, 26400.0, 26430.0, 26460.0, 26490.0, 26520.0, 26550.0, 26580.0, 26610.0, 26640.0,
                        26670.0, 26700.0, 26730.0, 26760.0, 26790.0, 26820.0, 26850.0, 26880.0, 26910.0, 26940.0,
                        26970.0, 27000.0, 27030.0, 27060.0, 27090.0, 27120.0, 27150.0, 27180.0, 27210.0, 27240.0,
                        27270.0, 27300.0, 27330.0, 27360.0, 27390.0, 27420.0, 27450.0, 27480.0, 27510.0, 27540.0,
                        27570.0, 27600.0, 27630.0, 27660.0, 27690.0, 27720.0, 27750.0, 27780.0, 27810.0, 27840.0,
                        27870.0, 27900.0, 27930.0, 27960.0, 27990.0, 28020.0, 28050.0, 28080.0, 28110.0, 28140.0,
                        28170.0, 28200.0, 28230.0, 28260.0, 28290.0, 28320.0, 28350.0, 28380.0, 28410.0, 28440.0,
                        28470.0, 28500.0, 28530.0, 28560.0, 28590.0, 28620.0, 28650.0, 28680.0, 28710.0, 28740.0,
                        28770.0, 28800.0, 28830.0, 28860.0, 28890.0, 28920.0, 28950.0, 28980.0, 29010.0, 29040.0,
                        29070.0, 29100.0, 29130.0, 29160.0, 29190.0, 29220.0, 29250.0, 29280.0, 29310.0, 29340.0,
                        29370.0, 29400.0, 29430.0, 29460.0, 29490.0, 29520.0, 29550.0, 29580.0, 29610.0, 29640.0,
                        29670.0, 29700.0, 29730.0, 29760.0, 29790.0, 29820.0, 29850.0, 29880.0, 29910.0, 29940.0,
                        29970.0, 30000.0, 30030.0, 30060.0, 30090.0, 30120.0, 30150.0, 30180.0, 30210.0, 30240.0,
                        30270.0, 30300.0, 30330.0, 30360.0, 30390.0, 30420.0, 30450.0, 30480.0, 30510.0, 30540.0,
                        30570.0, 30600.0, 30630.0, 30660.0],
        "starttime": datetime.datetime(2013, 10, 18, 16, 40, 6),
        "mins_in_0": 97.0, "mins_in_1": 45.0, "mins_in_2": 168.0, "mins_in_3": 89.5, "mins_in_4": 112.0,
        "sleep_efficiency": 0.8103616813294232, "total_sleep_time": 414.5
    }

    assert (dict_out == correct_return)


def test_edf2_scorefile():
    dict_out = automated_parsing(filepath="testfiles/edftype2_scorefile.edf",
                                 fileformat="scorefile",
                                 filetype="Scoring",
                                 subjectid=2,
                                 visitid=1,
                                 sessionid=1,
                                 studyid="Kemp")

    correct_return = {
        "studyid": "Kemp",
        "subjectid": 2,
        "visitid": 1,
        "session": 1,
        "filetype": "Scoring",
        "fileformat": "scorefile",
        "epochstage": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1,
                       1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 0, 3, 3, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 3, 3, 3,
                       3, 1, 2, 2, 2, 2, 2, 3, 3, 2, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 3, 3, 3,
                       3, 3, 3, 3, 2, 2, 3, 3, 3, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 1, 1, 1, 1, 2,
                       2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 1,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 1, 1, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 3, 2, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 3, 3, 2, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1,
                       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 3, 2, 3, 3, 3, 2, 2, 2, 2, 3, 3, 2, 2, 3, 2, 3, 2, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2,
                       2, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                       1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "epochoffset": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0, 390.0,
                        420.0, 450.0, 480.0, 510.0, 540.0, 570.0, 600.0, 630.0, 660.0, 690.0, 720.0, 750.0, 780.0,
                        810.0, 840.0, 870.0, 900.0, 930.0, 960.0, 990.0, 1020.0, 1050.0, 1080.0, 1110.0, 1140.0, 1170.0,
                        1200.0, 1230.0, 1260.0, 1290.0, 1320.0, 1350.0, 1380.0, 1410.0, 1440.0, 1470.0, 1500.0, 1530.0,
                        1560.0, 1590.0, 1620.0, 1650.0, 1680.0, 1710.0, 1740.0, 1770.0, 1800.0, 1830.0, 1860.0, 1890.0,
                        1920.0, 1950.0, 1980.0, 2010.0, 2040.0, 2070.0, 2100.0, 2130.0, 2160.0, 2190.0, 2220.0, 2250.0,
                        2280.0, 2310.0, 2340.0, 2370.0, 2400.0, 2430.0, 2460.0, 2490.0, 2520.0, 2550.0, 2580.0, 2610.0,
                        2640.0, 2670.0, 2700.0, 2730.0, 2760.0, 2790.0, 2820.0, 2850.0, 2880.0, 2910.0, 2940.0, 2970.0,
                        3000.0, 3030.0, 3060.0, 3090.0, 3120.0, 3150.0, 3180.0, 3210.0, 3240.0, 3270.0, 3300.0, 3330.0,
                        3360.0, 3390.0, 3420.0, 3450.0, 3480.0, 3510.0, 3540.0, 3570.0, 3600.0, 3630.0, 3660.0, 3690.0,
                        3720.0, 3750.0, 3780.0, 3810.0, 3840.0, 3870.0, 3900.0, 3930.0, 3960.0, 3990.0, 4020.0, 4050.0,
                        4080.0, 4110.0, 4140.0, 4170.0, 4200.0, 4230.0, 4260.0, 4290.0, 4320.0, 4350.0, 4380.0, 4410.0,
                        4440.0, 4470.0, 4500.0, 4530.0, 4560.0, 4590.0, 4620.0, 4650.0, 4680.0, 4710.0, 4740.0, 4770.0,
                        4800.0, 4830.0, 4860.0, 4890.0, 4920.0, 4950.0, 4980.0, 5010.0, 5040.0, 5070.0, 5100.0, 5130.0,
                        5160.0, 5190.0, 5220.0, 5250.0, 5280.0, 5310.0, 5340.0, 5370.0, 5400.0, 5430.0, 5460.0, 5490.0,
                        5520.0, 5550.0, 5580.0, 5610.0, 5640.0, 5670.0, 5700.0, 5730.0, 5760.0, 5790.0, 5820.0, 5850.0,
                        5880.0, 5910.0, 5940.0, 5970.0, 6000.0, 6030.0, 6060.0, 6090.0, 6120.0, 6150.0, 6180.0, 6210.0,
                        6240.0, 6270.0, 6300.0, 6330.0, 6360.0, 6390.0, 6420.0, 6450.0, 6480.0, 6510.0, 6540.0, 6570.0,
                        6600.0, 6630.0, 6660.0, 6690.0, 6720.0, 6750.0, 6780.0, 6810.0, 6840.0, 6870.0, 6900.0, 6930.0,
                        6960.0, 6990.0, 7020.0, 7050.0, 7080.0, 7110.0, 7140.0, 7170.0, 7200.0, 7230.0, 7260.0, 7290.0,
                        7320.0, 7350.0, 7380.0, 7410.0, 7440.0, 7470.0, 7500.0, 7530.0, 7560.0, 7590.0, 7620.0, 7650.0,
                        7680.0, 7710.0, 7740.0, 7770.0, 7800.0, 7830.0, 7860.0, 7890.0, 7920.0, 7950.0, 7980.0, 8010.0,
                        8040.0, 8070.0, 8100.0, 8130.0, 8160.0, 8190.0, 8220.0, 8250.0, 8280.0, 8310.0, 8340.0, 8370.0,
                        8400.0, 8430.0, 8460.0, 8490.0, 8520.0, 8550.0, 8580.0, 8610.0, 8640.0, 8670.0, 8700.0, 8730.0,
                        8760.0, 8790.0, 8820.0, 8850.0, 8880.0, 8910.0, 8940.0, 8970.0, 9000.0, 9030.0, 9060.0, 9090.0,
                        9120.0, 9150.0, 9180.0, 9210.0, 9240.0, 9270.0, 9300.0, 9330.0, 9360.0, 9390.0, 9420.0, 9450.0,
                        9480.0, 9510.0, 9540.0, 9570.0, 9600.0, 9630.0, 9660.0, 9690.0, 9720.0, 9750.0, 9780.0, 9810.0,
                        9840.0, 9870.0, 9900.0, 9930.0, 9960.0, 9990.0, 10020.0, 10050.0, 10080.0, 10110.0, 10140.0,
                        10170.0, 10200.0, 10230.0, 10260.0, 10290.0, 10320.0, 10350.0, 10380.0, 10410.0, 10440.0,
                        10470.0, 10500.0, 10530.0, 10560.0, 10590.0, 10620.0, 10650.0, 10680.0, 10710.0, 10740.0,
                        10770.0, 10800.0, 10830.0, 10860.0, 10890.0, 10920.0, 10950.0, 10980.0, 11010.0, 11040.0,
                        11070.0, 11100.0, 11130.0, 11160.0, 11190.0, 11220.0, 11250.0, 11280.0, 11310.0, 11340.0,
                        11370.0, 11400.0, 11430.0, 11460.0, 11490.0, 11520.0, 11550.0, 11580.0, 11610.0, 11640.0,
                        11670.0, 11700.0, 11730.0, 11760.0, 11790.0, 11820.0, 11850.0, 11880.0, 11910.0, 11940.0,
                        11970.0, 12000.0, 12030.0, 12060.0, 12090.0, 12120.0, 12150.0, 12180.0, 12210.0, 12240.0,
                        12270.0, 12300.0, 12330.0, 12360.0, 12390.0, 12420.0, 12450.0, 12480.0, 12510.0, 12540.0,
                        12570.0, 12600.0, 12630.0, 12660.0, 12690.0, 12720.0, 12750.0, 12780.0, 12810.0, 12840.0,
                        12870.0, 12900.0, 12930.0, 12960.0, 12990.0, 13020.0, 13050.0, 13080.0, 13110.0, 13140.0,
                        13170.0, 13200.0, 13230.0, 13260.0, 13290.0, 13320.0, 13350.0, 13380.0, 13410.0, 13440.0,
                        13470.0, 13500.0, 13530.0, 13560.0, 13590.0, 13620.0, 13650.0, 13680.0, 13710.0, 13740.0,
                        13770.0, 13800.0, 13830.0, 13860.0, 13890.0, 13920.0, 13950.0, 13980.0, 14010.0, 14040.0,
                        14070.0, 14100.0, 14130.0, 14160.0, 14190.0, 14220.0, 14250.0, 14280.0, 14310.0, 14340.0,
                        14370.0, 14400.0, 14430.0, 14460.0, 14490.0, 14520.0, 14550.0, 14580.0, 14610.0, 14640.0,
                        14670.0, 14700.0, 14730.0, 14760.0, 14790.0, 14820.0, 14850.0, 14880.0, 14910.0, 14940.0,
                        14970.0, 15000.0, 15030.0, 15060.0, 15090.0, 15120.0, 15150.0, 15180.0, 15210.0, 15240.0,
                        15270.0, 15300.0, 15330.0, 15360.0, 15390.0, 15420.0, 15450.0, 15480.0, 15510.0, 15540.0,
                        15570.0, 15600.0, 15630.0, 15660.0, 15690.0, 15720.0, 15750.0, 15780.0, 15810.0, 15840.0,
                        15870.0, 15900.0, 15930.0, 15960.0, 15990.0, 16020.0, 16050.0, 16080.0, 16110.0, 16140.0,
                        16170.0, 16200.0, 16230.0, 16260.0, 16290.0, 16320.0, 16350.0, 16380.0, 16410.0, 16440.0,
                        16470.0, 16500.0, 16530.0, 16560.0, 16590.0, 16620.0, 16650.0, 16680.0, 16710.0, 16740.0,
                        16770.0, 16800.0, 16830.0, 16860.0, 16890.0, 16920.0, 16950.0, 16980.0, 17010.0, 17040.0,
                        17070.0, 17100.0, 17130.0, 17160.0, 17190.0, 17220.0, 17250.0, 17280.0, 17310.0, 17340.0,
                        17370.0, 17400.0, 17430.0, 17460.0, 17490.0, 17520.0, 17550.0, 17580.0, 17610.0, 17640.0,
                        17670.0, 17700.0, 17730.0, 17760.0, 17790.0, 17820.0, 17850.0, 17880.0, 17910.0, 17940.0,
                        17970.0, 18000.0, 18030.0, 18060.0, 18090.0, 18120.0, 18150.0, 18180.0, 18210.0, 18240.0,
                        18270.0, 18300.0, 18330.0, 18360.0, 18390.0, 18420.0, 18450.0, 18480.0, 18510.0, 18540.0,
                        18570.0, 18600.0, 18630.0, 18660.0, 18690.0, 18720.0, 18750.0, 18780.0, 18810.0, 18840.0,
                        18870.0, 18900.0, 18930.0, 18960.0, 18990.0, 19020.0, 19050.0, 19080.0, 19110.0, 19140.0,
                        19170.0, 19200.0, 19230.0, 19260.0, 19290.0, 19320.0, 19350.0, 19380.0, 19410.0, 19440.0,
                        19470.0, 19500.0, 19530.0, 19560.0, 19590.0, 19620.0, 19650.0, 19680.0, 19710.0, 19740.0,
                        19770.0, 19800.0, 19830.0, 19860.0, 19890.0, 19920.0, 19950.0, 19980.0, 20010.0, 20040.0,
                        20070.0, 20100.0, 20130.0, 20160.0, 20190.0, 20220.0, 20250.0, 20280.0, 20310.0, 20340.0,
                        20370.0, 20400.0, 20430.0, 20460.0, 20490.0, 20520.0, 20550.0, 20580.0, 20610.0, 20640.0,
                        20670.0, 20700.0, 20730.0, 20760.0, 20790.0, 20820.0, 20850.0, 20880.0, 20910.0, 20940.0,
                        20970.0, 21000.0, 21030.0, 21060.0, 21090.0, 21120.0, 21150.0, 21180.0, 21210.0, 21240.0,
                        21270.0, 21300.0, 21330.0, 21360.0, 21390.0, 21420.0, 21450.0, 21480.0, 21510.0, 21540.0,
                        21570.0, 21600.0, 21630.0, 21660.0, 21690.0, 21720.0, 21750.0, 21780.0, 21810.0, 21840.0,
                        21870.0, 21900.0, 21930.0, 21960.0, 21990.0, 22020.0, 22050.0, 22080.0, 22110.0, 22140.0,
                        22170.0, 22200.0, 22230.0, 22260.0, 22290.0, 22320.0, 22350.0, 22380.0, 22410.0, 22440.0,
                        22470.0, 22500.0, 22530.0, 22560.0, 22590.0, 22620.0, 22650.0, 22680.0, 22710.0, 22740.0,
                        22770.0, 22800.0, 22830.0, 22860.0, 22890.0, 22920.0, 22950.0, 22980.0, 23010.0, 23040.0,
                        23070.0, 23100.0, 23130.0, 23160.0, 23190.0, 23220.0, 23250.0, 23280.0, 23310.0, 23340.0,
                        23370.0, 23400.0, 23430.0, 23460.0, 23490.0, 23520.0, 23550.0, 23580.0, 23610.0, 23640.0,
                        23670.0, 23700.0, 23730.0, 23760.0, 23790.0, 23820.0, 23850.0, 23880.0, 23910.0, 23940.0,
                        23970.0, 24000.0, 24030.0, 24060.0, 24090.0, 24120.0, 24150.0, 24180.0, 24210.0, 24240.0,
                        24270.0, 24300.0, 24330.0, 24360.0, 24390.0, 24420.0, 24450.0, 24480.0, 24510.0, 24540.0,
                        24570.0, 24600.0, 24630.0, 24660.0, 24690.0, 24720.0, 24750.0, 24780.0, 24810.0, 24840.0,
                        24870.0, 24900.0, 24930.0, 24960.0, 24990.0, 25020.0, 25050.0, 25080.0, 25110.0, 25140.0,
                        25170.0, 25200.0, 25230.0, 25260.0, 25290.0, 25320.0, 25350.0, 25380.0, 25410.0, 25440.0,
                        25470.0, 25500.0, 25530.0, 25560.0, 25590.0, 25620.0, 25650.0, 25680.0, 25710.0, 25740.0,
                        25770.0, 25800.0, 25830.0, 25860.0, 25890.0, 25920.0, 25950.0, 25980.0, 26010.0, 26040.0,
                        26070.0, 26100.0, 26130.0, 26160.0, 26190.0, 26220.0, 26250.0, 26280.0, 26310.0, 26340.0,
                        26370.0, 26400.0, 26430.0, 26460.0, 26490.0, 26520.0, 26550.0, 26580.0, 26610.0, 26640.0,
                        26670.0, 26700.0, 26730.0, 26760.0, 26790.0, 26820.0, 26850.0, 26880.0, 26910.0, 26940.0,
                        26970.0, 27000.0, 27030.0, 27060.0, 27090.0, 27120.0, 27150.0, 27180.0, 27210.0, 27240.0,
                        27270.0, 27300.0, 27330.0, 27360.0, 27390.0, 27420.0, 27450.0, 27480.0, 27510.0, 27540.0,
                        27570.0, 27600.0, 27630.0, 27660.0, 27690.0, 27720.0, 27750.0, 27780.0, 27810.0, 27840.0,
                        27870.0, 27900.0, 27930.0, 27960.0, 27990.0, 28020.0, 28050.0, 28080.0, 28110.0, 28140.0,
                        28170.0, 28200.0, 28230.0, 28260.0, 28290.0, 28320.0, 28350.0, 28380.0, 28410.0, 28440.0,
                        28470.0, 28500.0, 28530.0, 28560.0, 28590.0, 28620.0, 28650.0, 28680.0, 28710.0, 28740.0,
                        28770.0, 28800.0, 28830.0, 28860.0, 28890.0, 28920.0, 28950.0, 28980.0, 29010.0, 29040.0,
                        29070.0, 29100.0, 29130.0, 29160.0, 29190.0, 29220.0, 29250.0, 29280.0, 29310.0, 29340.0,
                        29370.0, 29400.0, 29430.0, 29460.0, 29490.0, 29520.0, 29550.0, 29580.0, 29610.0, 29640.0,
                        29670.0, 29700.0, 29730.0, 29760.0, 29790.0, 29820.0, 29850.0, 29880.0, 29910.0, 29940.0,
                        29970.0, 30000.0, 30030.0, 30060.0, 30090.0, 30120.0, 30150.0, 30180.0, 30210.0, 30240.0,
                        30270.0, 30300.0, 30330.0, 30360.0, 30390.0, 30420.0, 30450.0, 30480.0, 30510.0, 30540.0,
                        30570.0, 30600.0, 30630.0, 30660.0, 30690.0, 30720.0, 30750.0, 30780.0, 30810.0, 30840.0,
                        30870.0, 30900.0, 30930.0, 30960.0, 30990.0, 31020.0, 31050.0, 31080.0, 31110.0, 31140.0,
                        31170.0, 31200.0, 31230.0, 31260.0, 31290.0, 31320.0, 31350.0, 31380.0, 31410.0, 31440.0,
                        31470.0, 31500.0, 31530.0, 31560.0, 31590.0, 31620.0, 31650.0, 31680.0, 31710.0, 31740.0,
                        31770.0, 31800.0, 31830.0, 31860.0, 31890.0, 31920.0, 31950.0, 31980.0, 32010.0, 32040.0,
                        32070.0, 32100.0, 32130.0, 32160.0, 32190.0, 32220.0, 32250.0, 32280.0, 32310.0, 32340.0,
                        32370.0, 32400.0, 32430.0, 32460.0, 32490.0, 32520.0, 32550.0, 32580.0, 32610.0, 32640.0,
                        32670.0, 32700.0, 32730.0, 32760.0, 32790.0, 32820.0, 32850.0, 32880.0, 32910.0, 32940.0,
                        32970.0, 33000.0, 33030.0, 33060.0, 33090.0, 33120.0, 33150.0, 33180.0, 33210.0, 33240.0,
                        33270.0, 33300.0, 33330.0, 33360.0, 33390.0, 33420.0, 33450.0, 33480.0, 33510.0, 33540.0,
                        33570.0, 33600.0, 33630.0, 33660.0, 33690.0, 33720.0, 33750.0, 33780.0, 33810.0, 33840.0,
                        33870.0, 33900.0, 33930.0, 33960.0, 33990.0, 34020.0, 34050.0, 34080.0, 34110.0, 34140.0,
                        34170.0, 34200.0, 34230.0, 34260.0, 34290.0, 34320.0, 34350.0, 34380.0, 34410.0, 34440.0,
                        34470.0, 34500.0, 34530.0, 34560.0, 34590.0, 34620.0, 34650.0, 34680.0, 34710.0, 34740.0,
                        34770.0, 34800.0, 34830.0, 34860.0, 34890.0, 34920.0, 34950.0, 34980.0, 35010.0, 35040.0,
                        35070.0, 35100.0, 35130.0, 35160.0, 35190.0, 35220.0, 35250.0, 35280.0, 35310.0, 35340.0,
                        35370.0, 35400.0, 35430.0, 35460.0, 35490.0, 35520.0, 35550.0, 35580.0, 35610.0, 35640.0,
                        35670.0, 35700.0, 35730.0, 35760.0, 35790.0, 35820.0, 35850.0, 35880.0, 35910.0, 35940.0,
                        35970.0, 36000.0, 36030.0, 36060.0, 36090.0, 36120.0, 36150.0, 36180.0, 36210.0, 36240.0,
                        36270.0, 36300.0, 36330.0, 36360.0, 36390.0, 36420.0, 36450.0, 36480.0, 36510.0, 36540.0,
                        36570.0, 36600.0, 36630.0, 36660.0, 36690.0, 36720.0, 36750.0, 36780.0, 36810.0, 36840.0,
                        36870.0, 36900.0, 36930.0, 36960.0, 36990.0, 37020.0, 37050.0, 37080.0, 37110.0, 37140.0,
                        37170.0, 37200.0, 37230.0, 37260.0, 37290.0, 37320.0, 37350.0, 37380.0, 37410.0, 37440.0,
                        37470.0, 37500.0, 37530.0, 37560.0, 37590.0, 37620.0, 37650.0, 37680.0, 37710.0, 37740.0,
                        37770.0, 37800.0, 37830.0, 37860.0, 37890.0, 37920.0, 37950.0, 37980.0, 38010.0, 38040.0,
                        38070.0, 38100.0, 38130.0, 38160.0, 38190.0, 38220.0, 38250.0, 38280.0, 38310.0, 38340.0,
                        38370.0, 38400.0, 38430.0, 38460.0, 38490.0, 38520.0, 38550.0, 38580.0, 38610.0, 38640.0,
                        38670.0, 38700.0, 38730.0, 38760.0, 38790.0, 38820.0, 38850.0, 38880.0, 38910.0, 38940.0,
                        38970.0, 39000.0, 39030.0, 39060.0, 39090.0, 39120.0, 39150.0, 39180.0, 39210.0, 39240.0,
                        39270.0, 39300.0, 39330.0, 39360.0, 39390.0, 39420.0, 39450.0, 39480.0, 39510.0, 39540.0,
                        39570.0, 39600.0, 39630.0, 39660.0, 39690.0, 39720.0, 39750.0, 39780.0, 39810.0, 39840.0,
                        39870.0, 39900.0, 39930.0, 39960.0, 39990.0, 40020.0, 40050.0, 40080.0, 40110.0, 40140.0,
                        40170.0, 40200.0, 40230.0, 40260.0, 40290.0, 40320.0, 40350.0, 40380.0, 40410.0, 40440.0,
                        40470.0, 40500.0, 40530.0, 40560.0, 40590.0, 40620.0, 40650.0, 40680.0, 40710.0, 40740.0,
                        40770.0, 40800.0, 40830.0, 40860.0, 40890.0, 40920.0, 40950.0, 40980.0, 41010.0, 41040.0,
                        41070.0, 41100.0, 41130.0, 41160.0, 41190.0, 41220.0, 41250.0, 41280.0, 41310.0, 41340.0,
                        41370.0, 41400.0, 41430.0, 41460.0, 41490.0, 41520.0, 41550.0, 41580.0, 41610.0, 41640.0,
                        41670.0, 41700.0, 41730.0, 41760.0, 41790.0, 41820.0, 41850.0, 41880.0, 41910.0, 41940.0,
                        41970.0, 42000.0, 42030.0, 42060.0, 42090.0, 42120.0, 42150.0, 42180.0, 42210.0, 42240.0,
                        42270.0, 42300.0, 42330.0, 42360.0, 42390.0, 42420.0, 42450.0, 42480.0, 42510.0, 42540.0,
                        42570.0, 42600.0, 42630.0, 42660.0, 42690.0, 42720.0, 42750.0, 42780.0, 42810.0, 42840.0,
                        42870.0, 42900.0, 42930.0, 42960.0, 42990.0, 43020.0, 43050.0, 43080.0, 43110.0, 43140.0,
                        43170.0, 43200.0, 43230.0, 43260.0, 43290.0, 43320.0, 43350.0, 43380.0, 43410.0, 43440.0,
                        43470.0, 43500.0, 43530.0, 43560.0, 43590.0, 43620.0, 43650.0, 43680.0, 43710.0, 43740.0,
                        43770.0, 43800.0, 43830.0, 43860.0, 43890.0, 43920.0, 43950.0, 43980.0, 44010.0, 44040.0,
                        44070.0, 44100.0, 44130.0, 44160.0, 44190.0, 44220.0, 44250.0, 44280.0, 44310.0, 44340.0,
                        44370.0, 44400.0, 44430.0, 44460.0, 44490.0, 44520.0, 44550.0, 44580.0, 44610.0, 44640.0,
                        44670.0, 44700.0, 44730.0, 44760.0, 44790.0, 44820.0, 44850.0, 44880.0, 44910.0, 44940.0,
                        44970.0, 45000.0, 45030.0, 45060.0, 45090.0, 45120.0, 45150.0, 45180.0, 45210.0, 45240.0,
                        45270.0, 45300.0, 45330.0, 45360.0, 45390.0, 45420.0, 45450.0, 45480.0, 45510.0, 45540.0,
                        45570.0, 45600.0, 45630.0, 45660.0, 45690.0, 45720.0, 45750.0, 45780.0, 45810.0, 45840.0,
                        45870.0, 45900.0, 45930.0, 45960.0, 45990.0, 46020.0, 46050.0, 46080.0, 46110.0, 46140.0,
                        46170.0, 46200.0, 46230.0, 46260.0, 46290.0, 46320.0, 46350.0, 46380.0, 46410.0, 46440.0,
                        46470.0, 46500.0, 46530.0, 46560.0, 46590.0, 46620.0, 46650.0, 46680.0, 46710.0, 46740.0,
                        46770.0, 46800.0, 46830.0, 46860.0, 46890.0, 46920.0, 46950.0, 46980.0, 47010.0, 47040.0,
                        47070.0, 47100.0, 47130.0, 47160.0, 47190.0, 47220.0, 47250.0, 47280.0, 47310.0, 47340.0,
                        47370.0, 47400.0, 47430.0, 47460.0, 47490.0, 47520.0, 47550.0, 47580.0, 47610.0, 47640.0,
                        47670.0, 47700.0, 47730.0, 47760.0, 47790.0, 47820.0, 47850.0, 47880.0, 47910.0, 47940.0,
                        47970.0, 48000.0, 48030.0, 48060.0, 48090.0, 48120.0, 48150.0, 48180.0, 48210.0, 48240.0,
                        48270.0, 48300.0, 48330.0, 48360.0, 48390.0, 48420.0, 48450.0, 48480.0, 48510.0, 48540.0,
                        48570.0, 48600.0, 48630.0, 48660.0, 48690.0, 48720.0, 48750.0, 48780.0, 48810.0, 48840.0,
                        48870.0, 48900.0, 48930.0, 48960.0, 48990.0, 49020.0, 49050.0, 49080.0, 49110.0, 49140.0,
                        49170.0, 49200.0, 49230.0, 49260.0, 49290.0, 49320.0, 49350.0, 49380.0, 49410.0, 49440.0,
                        49470.0, 49500.0, 49530.0, 49560.0, 49590.0, 49620.0, 49650.0, 49680.0, 49710.0, 49740.0,
                        49770.0, 49800.0, 49830.0, 49860.0, 49890.0, 49920.0, 49950.0, 49980.0, 50010.0, 50040.0,
                        50070.0, 50100.0, 50130.0, 50160.0, 50190.0, 50220.0, 50250.0, 50280.0, 50310.0, 50340.0,
                        50370.0, 50400.0, 50430.0, 50460.0, 50490.0, 50520.0, 50550.0, 50580.0, 50610.0, 50640.0,
                        50670.0, 50700.0, 50730.0, 50760.0, 50790.0, 50820.0, 50850.0, 50880.0, 50910.0, 50940.0,
                        50970.0, 51000.0, 51030.0, 51060.0, 51090.0, 51120.0, 51150.0, 51180.0, 51210.0, 51240.0,
                        51270.0, 51300.0, 51330.0, 51360.0, 51390.0, 51420.0, 51450.0, 51480.0, 51510.0, 51540.0,
                        51570.0, 51600.0, 51630.0, 51660.0, 51690.0, 51720.0, 51750.0, 51780.0, 51810.0, 51840.0,
                        51870.0, 51900.0, 51930.0, 51960.0, 51990.0, 52020.0, 52050.0, 52080.0, 52110.0, 52140.0,
                        52170.0, 52200.0, 52230.0, 52260.0, 52290.0, 52320.0, 52350.0, 52380.0, 52410.0, 52440.0,
                        52470.0, 52500.0, 52530.0, 52560.0, 52590.0, 52620.0, 52650.0, 52680.0, 52710.0, 52740.0,
                        52770.0, 52800.0, 52830.0, 52860.0, 52890.0, 52920.0, 52950.0, 52980.0, 53010.0, 53040.0,
                        53070.0, 53100.0, 53130.0, 53160.0, 53190.0, 53220.0, 53250.0, 53280.0, 53310.0, 53340.0,
                        53370.0, 53400.0, 53430.0, 53460.0, 53490.0, 53520.0, 53550.0, 53580.0, 53610.0, 53640.0,
                        53670.0, 53700.0, 53730.0, 53760.0, 53790.0, 53820.0, 53850.0, 53880.0, 53910.0, 53940.0,
                        53970.0, 54000.0, 54030.0, 54060.0, 54090.0, 54120.0, 54150.0, 54180.0, 54210.0, 54240.0,
                        54270.0, 54300.0, 54330.0, 54360.0, 54390.0, 54420.0, 54450.0, 54480.0, 54510.0, 54540.0,
                        54570.0, 54600.0, 54630.0, 54660.0, 54690.0, 54720.0, 54750.0, 54780.0, 54810.0, 54840.0,
                        54870.0, 54900.0, 54930.0, 54960.0, 54990.0, 55020.0, 55050.0, 55080.0, 55110.0, 55140.0,
                        55170.0, 55200.0, 55230.0, 55260.0, 55290.0, 55320.0, 55350.0, 55380.0, 55410.0, 55440.0,
                        55470.0, 55500.0, 55530.0, 55560.0, 55590.0, 55620.0, 55650.0, 55680.0, 55710.0, 55740.0,
                        55770.0, 55800.0, 55830.0, 55860.0, 55890.0, 55920.0, 55950.0, 55980.0, 56010.0, 56040.0,
                        56070.0, 56100.0, 56130.0, 56160.0, 56190.0, 56220.0, 56250.0, 56280.0, 56310.0, 56340.0,
                        56370.0, 56400.0, 56430.0, 56460.0, 56490.0, 56520.0, 56550.0, 56580.0, 56610.0, 56640.0,
                        56670.0, 56700.0, 56730.0, 56760.0, 56790.0, 56820.0, 56850.0, 56880.0, 56910.0, 56940.0,
                        56970.0, 57000.0, 57030.0, 57060.0, 57090.0, 57120.0, 57150.0, 57180.0, 57210.0, 57240.0,
                        57270.0, 57300.0, 57330.0, 57360.0, 57390.0, 57420.0, 57450.0, 57480.0, 57510.0, 57540.0,
                        57570.0, 57600.0, 57630.0, 57660.0, 57690.0, 57720.0, 57750.0, 57780.0, 57810.0, 57840.0,
                        57870.0, 57900.0, 57930.0, 57960.0, 57990.0, 58020.0, 58050.0, 58080.0, 58110.0, 58140.0,
                        58170.0, 58200.0, 58230.0, 58260.0, 58290.0, 58320.0, 58350.0, 58380.0, 58410.0, 58440.0,
                        58470.0, 58500.0, 58530.0, 58560.0, 58590.0, 58620.0, 58650.0, 58680.0, 58710.0, 58740.0,
                        58770.0, 58800.0, 58830.0, 58860.0, 58890.0, 58920.0, 58950.0, 58980.0, 59010.0, 59040.0,
                        59070.0, 59100.0, 59130.0, 59160.0, 59190.0, 59220.0, 59250.0, 59280.0, 59310.0, 59340.0,
                        59370.0, 59400.0, 59430.0, 59460.0, 59490.0, 59520.0, 59550.0, 59580.0, 59610.0, 59640.0,
                        59670.0, 59700.0, 59730.0, 59760.0, 59790.0, 59820.0, 59850.0, 59880.0, 59910.0, 59940.0,
                        59970.0, 60000.0, 60030.0, 60060.0, 60090.0, 60120.0, 60150.0, 60180.0, 60210.0, 60240.0,
                        60270.0, 60300.0, 60330.0, 60360.0, 60390.0, 60420.0, 60450.0, 60480.0, 60510.0, 60540.0,
                        60570.0, 60600.0, 60630.0, 60660.0, 60690.0, 60720.0, 60750.0, 60780.0, 60810.0, 60840.0,
                        60870.0, 60900.0, 60930.0, 60960.0, 60990.0, 61020.0, 61050.0, 61080.0, 61110.0, 61140.0,
                        61170.0, 61200.0, 61230.0, 61260.0, 61290.0, 61320.0, 61350.0, 61380.0, 61410.0, 61440.0,
                        61470.0, 61500.0, 61530.0, 61560.0, 61590.0, 61620.0, 61650.0, 61680.0, 61710.0, 61740.0,
                        61770.0, 61800.0, 61830.0, 61860.0, 61890.0, 61920.0, 61950.0, 61980.0, 62010.0, 62040.0,
                        62070.0, 62100.0, 62130.0, 62160.0, 62190.0, 62220.0, 62250.0, 62280.0, 62310.0, 62340.0,
                        62370.0, 62400.0, 62430.0, 62460.0, 62490.0, 62520.0, 62550.0, 62580.0, 62610.0, 62640.0,
                        62670.0, 62700.0, 62730.0, 62760.0, 62790.0, 62820.0, 62850.0, 62880.0, 62910.0, 62940.0,
                        62970.0, 63000.0, 63030.0, 63060.0, 63090.0, 63120.0, 63150.0, 63180.0, 63210.0, 63240.0,
                        63270.0, 63300.0, 63330.0, 63360.0, 63390.0, 63420.0, 63450.0, 63480.0, 63510.0, 63540.0,
                        63570.0, 63600.0, 63630.0, 63660.0, 63690.0, 63720.0, 63750.0, 63780.0, 63810.0, 63840.0,
                        63870.0, 63900.0, 63930.0, 63960.0, 63990.0, 64020.0, 64050.0, 64080.0, 64110.0, 64140.0,
                        64170.0, 64200.0, 64230.0, 64260.0, 64290.0, 64320.0, 64350.0, 64380.0, 64410.0, 64440.0,
                        64470.0, 64500.0, 64530.0, 64560.0, 64590.0, 64620.0, 64650.0, 64680.0, 64710.0, 64740.0,
                        64770.0, 64800.0, 64830.0, 64860.0, 64890.0, 64920.0, 64950.0, 64980.0, 65010.0, 65040.0,
                        65070.0, 65100.0, 65130.0, 65160.0, 65190.0, 65220.0, 65250.0, 65280.0, 65310.0, 65340.0,
                        65370.0, 65400.0, 65430.0, 65460.0, 65490.0, 65520.0, 65550.0, 65580.0, 65610.0, 65640.0,
                        65670.0, 65700.0, 65730.0, 65760.0, 65790.0, 65820.0, 65850.0, 65880.0, 65910.0, 65940.0,
                        65970.0, 66000.0, 66030.0, 66060.0, 66090.0, 66120.0, 66150.0, 66180.0, 66210.0, 66240.0,
                        66270.0, 66300.0, 66330.0, 66360.0, 66390.0, 66420.0, 66450.0, 66480.0, 66510.0, 66540.0,
                        66570.0, 66600.0, 66630.0, 66660.0, 66690.0, 66720.0, 66750.0, 66780.0, 66810.0, 66840.0,
                        66870.0, 66900.0, 66930.0, 66960.0, 66990.0, 67020.0, 67050.0, 67080.0, 67110.0, 67140.0,
                        67170.0, 67200.0, 67230.0, 67260.0, 67290.0, 67320.0, 67350.0, 67380.0, 67410.0, 67440.0,
                        67470.0, 67500.0, 67530.0, 67560.0, 67590.0, 67620.0, 67650.0, 67680.0, 67710.0, 67740.0,
                        67770.0, 67800.0, 67830.0, 67860.0, 67890.0, 67920.0, 67950.0, 67980.0, 68010.0, 68040.0,
                        68070.0, 68100.0, 68130.0, 68160.0, 68190.0, 68220.0, 68250.0, 68280.0, 68310.0, 68340.0,
                        68370.0, 68400.0, 68430.0, 68460.0, 68490.0, 68520.0, 68550.0, 68580.0, 68610.0, 68640.0,
                        68670.0, 68700.0, 68730.0, 68760.0, 68790.0, 68820.0, 68850.0, 68880.0, 68910.0, 68940.0,
                        68970.0, 69000.0, 69030.0, 69060.0, 69090.0, 69120.0, 69150.0, 69180.0, 69210.0, 69240.0,
                        69270.0, 69300.0, 69330.0, 69360.0, 69390.0, 69420.0, 69450.0, 69480.0, 69510.0, 69540.0,
                        69570.0, 69600.0, 69630.0, 69660.0, 69690.0, 69720.0, 69750.0, 69780.0, 69810.0, 69840.0,
                        69870.0, 69900.0, 69930.0, 69960.0, 69990.0, 70020.0, 70050.0, 70080.0, 70110.0, 70140.0,
                        70170.0, 70200.0, 70230.0, 70260.0, 70290.0, 70320.0, 70350.0, 70380.0, 70410.0, 70440.0,
                        70470.0, 70500.0, 70530.0, 70560.0, 70590.0, 70620.0, 70650.0, 70680.0, 70710.0, 70740.0,
                        70770.0, 70800.0, 70830.0, 70860.0, 70890.0, 70920.0, 70950.0, 70980.0, 71010.0, 71040.0,
                        71070.0, 71100.0, 71130.0, 71160.0, 71190.0, 71220.0, 71250.0, 71280.0, 71310.0, 71340.0,
                        71370.0, 71400.0, 71430.0, 71460.0, 71490.0, 71520.0, 71550.0, 71580.0, 71610.0, 71640.0,
                        71670.0, 71700.0, 71730.0, 71760.0, 71790.0, 71820.0, 71850.0, 71880.0, 71910.0, 71940.0,
                        71970.0, 72000.0, 72030.0, 72060.0, 72090.0, 72120.0, 72150.0, 72180.0, 72210.0, 72240.0,
                        72270.0, 72300.0, 72330.0, 72360.0, 72390.0, 72420.0, 72450.0, 72480.0, 72510.0, 72540.0,
                        72570.0, 72600.0, 72630.0, 72660.0, 72690.0, 72720.0, 72750.0, 72780.0, 72810.0, 72840.0,
                        72870.0, 72900.0, 72930.0, 72960.0, 72990.0, 73020.0, 73050.0, 73080.0, 73110.0, 73140.0,
                        73170.0, 73200.0, 73230.0, 73260.0, 73290.0, 73320.0, 73350.0, 73380.0, 73410.0, 73440.0,
                        73470.0, 73500.0, 73530.0, 73560.0, 73590.0, 73620.0, 73650.0, 73680.0, 73710.0, 73740.0,
                        73770.0, 73800.0, 73830.0, 73860.0, 73890.0, 73920.0, 73950.0, 73980.0, 74010.0, 74040.0,
                        74070.0, 74100.0, 74130.0, 74160.0, 74190.0, 74220.0, 74250.0, 74280.0, 74310.0, 74340.0,
                        74370.0, 74400.0, 74430.0, 74460.0, 74490.0, 74520.0, 74550.0, 74580.0, 74610.0, 74640.0,
                        74670.0, 74700.0, 74730.0, 74760.0, 74790.0, 74820.0, 74850.0, 74880.0, 74910.0, 74940.0,
                        74970.0, 75000.0, 75030.0, 75060.0, 75090.0, 75120.0, 75150.0, 75180.0, 75210.0, 75240.0,
                        75270.0, 75300.0, 75330.0, 75360.0, 75390.0, 75420.0, 75450.0, 75480.0, 75510.0, 75540.0,
                        75570.0, 75600.0, 75630.0, 75660.0, 75690.0, 75720.0, 75750.0, 75780.0, 75810.0, 75840.0,
                        75870.0, 75900.0, 75930.0, 75960.0, 75990.0, 76020.0, 76050.0, 76080.0, 76110.0, 76140.0,
                        76170.0, 76200.0, 76230.0, 76260.0, 76290.0, 76320.0, 76350.0, 76380.0, 76410.0, 76440.0,
                        76470.0, 76500.0, 76530.0, 76560.0, 76590.0, 76620.0, 76650.0, 76680.0, 76710.0, 76740.0,
                        76770.0, 76800.0, 76830.0, 76860.0, 76890.0, 76920.0, 76950.0, 76980.0, 77010.0, 77040.0,
                        77070.0, 77100.0, 77130.0, 77160.0, 77190.0, 77220.0, 77250.0, 77280.0, 77310.0, 77340.0,
                        77370.0, 77400.0, 77430.0, 77460.0, 77490.0, 77520.0, 77550.0, 77580.0, 77610.0, 77640.0,
                        77670.0, 77700.0, 77730.0, 77760.0, 77790.0, 77820.0, 77850.0, 77880.0, 77910.0, 77940.0,
                        77970.0, 78000.0, 78030.0, 78060.0, 78090.0, 78120.0, 78150.0, 78180.0, 78210.0, 78240.0,
                        78270.0, 78300.0, 78330.0, 78360.0, 78390.0, 78420.0, 78450.0, 78480.0, 78510.0, 78540.0,
                        78570.0, 78600.0, 78630.0, 78660.0, 78690.0, 78720.0, 78750.0, 78780.0, 78810.0, 78840.0,
                        78870.0, 78900.0, 78930.0, 78960.0, 78990.0, 79020.0, 79050.0, 79080.0, 79110.0, 79140.0,
                        79170.0, 79200.0, 79230.0, 79260.0, 79290.0, 79320.0, 79350.0, 79380.0, 79410.0, 79440.0,
                        79470.0],
        "mins_in_0": 998.5, "mins_in_1": 58.5, "mins_in_2": 143.5, "mins_in_3": 124.5,
        "sleep_efficiency": 0.24641509433962264, "total_sleep_time": 326.5
    }

    assert (dict_out == correct_return)


def test_edf3_scorefile():
    dict_out = automated_parsing(filepath="testfiles/edftype3_scorefile.edf",
                                 fileformat="scorefile",
                                 filetype="Scoring",
                                 subjectid=2,
                                 visitid=1,
                                 sessionid=1,
                                 studyid="MASS")

    correct_return = {
        "studyid": "MASS",
        "subjectid": 2,
        "visitid": 1,
        "session": 1,
        "filetype": "Scoring",
        "fileformat": "scorefile",
        "epochstage": [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                       -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                       -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                       -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       3, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 0, 4, 4, 1, 4, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2, 4, 4, 4, 4, 4, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 3, 2, 2, 3, 3, 2, 3, 3, 2,
                       3, 3, 3, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 0, 1, 2, 2, 2, 2, 0, 1, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 2, 2, 2, 3, 2, 3,
                       2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 1, 1, 1, 1, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 3, 2, 2, 2, 3, 2, 3, 3, 2, 2, 2, 2, 2, 3, 2, 3, 3, 3, 2, 2, 2, 2, 2, 2, 3, 3, 2, 2,
                       3, 2, 3, 3, 2, 2, 3, 2, 2, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 0, 1, 2, 2, 2, 2,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 1, 1, 2, 2, 4, 4, 4, 4, 4, 1, 2,
                       4, 4, 4, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                       0, 0, 1, 1, 0, 0, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 1,
                       2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                       4, 4, 4, 4, 4, 4, 4, -1, -1, -1],
        "epochoffset": [15.25, 45.25, 75.25, 105.25, 135.25, 165.25, 195.25, 225.25, 255.25, 285.25, 315.25, 345.25,
                        375.25, 405.25, 435.25, 465.25, 495.25, 525.25, 555.25, 585.25, 615.25, 645.25, 675.25, 705.25,
                        735.25, 765.25, 795.25, 825.25, 855.25, 885.25, 915.25, 945.25, 975.25, 1005.25, 1035.25,
                        1065.25, 1095.25, 1125.25, 1155.25, 1185.25, 1215.25, 1245.25, 1275.25, 1305.25, 1335.25,
                        1365.25, 1395.25, 1425.25, 1455.25, 1485.25, 1515.25, 1545.25, 1575.25, 1605.25, 1635.25,
                        1665.25, 1695.25, 1725.25, 1755.25, 1785.25, 1815.25, 1845.25, 1875.25, 1905.25, 1935.25,
                        1965.25, 1995.25, 2025.25, 2055.25, 2085.25, 2115.25, 2145.25, 2175.25, 2205.25, 2235.25,
                        2265.25, 2295.25, 2325.25, 2355.25, 2385.25, 2415.25, 2445.25, 2475.25, 2505.25, 2535.25,
                        2565.25, 2595.25, 2625.25, 2655.25, 2685.25, 2715.25, 2745.25, 2775.25, 2805.25, 2835.25,
                        2865.25, 2895.25, 2925.25, 2955.25, 2985.25, 3015.25, 3045.25, 3075.25, 3105.25, 3135.25,
                        3165.25, 3195.25, 3225.25, 3255.25, 3285.25, 3315.25, 3345.25, 3375.25, 3405.25, 3435.25,
                        3465.25, 3495.25, 3525.25, 3555.25, 3585.25, 3615.25, 3645.25, 3675.25, 3705.25, 3735.25,
                        3765.25, 3795.25, 3825.25, 3855.25, 3885.25, 3915.25, 3945.25, 3975.25, 4005.25, 4035.25,
                        4065.25, 4095.25, 4125.25, 4155.25, 4185.25, 4215.25, 4245.25, 4275.25, 4305.25, 4335.25,
                        4365.25, 4395.25, 4425.25, 4455.25, 4485.25, 4515.25, 4545.25, 4575.25, 4605.25, 4635.25,
                        4665.25, 4695.25, 4725.25, 4755.25, 4785.25, 4815.25, 4845.25, 4875.25, 4905.25, 4935.25,
                        4965.25, 4995.25, 5025.25, 5055.25, 5085.25, 5115.25, 5145.25, 5175.25, 5205.25, 5235.25,
                        5265.25, 5295.25, 5325.25, 5355.25, 5385.25, 5415.25, 5445.25, 5475.25, 5505.25, 5535.25,
                        5565.25, 5595.25, 5625.25, 5655.25, 5685.25, 5715.25, 5745.25, 5775.25, 5805.25, 5835.25,
                        5865.25, 5895.25, 5925.25, 5955.25, 5985.25, 6015.25, 6045.25, 6075.25, 6105.25, 6135.25,
                        6165.25, 6195.25, 6225.25, 6255.25, 6285.25, 6315.25, 6345.25, 6375.25, 6405.25, 6435.25,
                        6465.25, 6495.25, 6525.25, 6555.25, 6585.25, 6615.25, 6645.25, 6675.25, 6705.25, 6735.25,
                        6765.25, 6795.25, 6825.25, 6855.25, 6885.25, 6915.25, 6945.25, 6975.25, 7005.25, 7035.25,
                        7065.25, 7095.25, 7125.25, 7155.25, 7185.25, 7215.25, 7245.25, 7275.25, 7305.25, 7335.25,
                        7365.25, 7395.25, 7425.25, 7455.25, 7485.25, 7515.25, 7545.25, 7575.25, 7605.25, 7635.25,
                        7665.25, 7695.25, 7725.25, 7755.25, 7785.25, 7815.25, 7845.25, 7875.25, 7905.25, 7935.25,
                        7965.25, 7995.25, 8025.25, 8055.25, 8085.25, 8115.25, 8145.25, 8175.25, 8205.25, 8235.25,
                        8265.25, 8295.25, 8325.25, 8355.25, 8385.25, 8415.25, 8445.25, 8475.25, 8505.25, 8535.25,
                        8565.25, 8595.25, 8625.25, 8655.25, 8685.25, 8715.25, 8745.25, 8775.25, 8805.25, 8835.25,
                        8865.25, 8895.25, 8925.25, 8955.25, 8985.25, 9015.25, 9045.25, 9075.25, 9105.25, 9135.25,
                        9165.25, 9195.25, 9225.25, 9255.25, 9285.25, 9315.25, 9345.25, 9375.25, 9405.25, 9435.25,
                        9465.25, 9495.25, 9525.25, 9555.25, 9585.25, 9615.25, 9645.25, 9675.25, 9705.25, 9735.25,
                        9765.25, 9795.25, 9825.25, 9855.25, 9885.25, 9915.25, 9945.25, 9975.25, 10005.25, 10035.25,
                        10065.25, 10095.25, 10125.25, 10155.25, 10185.25, 10215.25, 10245.25, 10275.25, 10305.25,
                        10335.25, 10365.25, 10395.25, 10425.25, 10455.25, 10485.25, 10515.25, 10545.25, 10575.25,
                        10605.25, 10635.25, 10665.25, 10695.25, 10725.25, 10755.25, 10785.25, 10815.25, 10845.25,
                        10875.25, 10905.25, 10935.25, 10965.25, 10995.25, 11025.25, 11055.25, 11085.25, 11115.25,
                        11145.25, 11175.25, 11205.25, 11235.25, 11265.25, 11295.25, 11325.25, 11355.25, 11385.25,
                        11415.25, 11445.25, 11475.25, 11505.25, 11535.25, 11565.25, 11595.25, 11625.25, 11655.25,
                        11685.25, 11715.25, 11745.25, 11775.25, 11805.25, 11835.25, 11865.25, 11895.25, 11925.25,
                        11955.25, 11985.25, 12015.25, 12045.25, 12075.25, 12105.25, 12135.25, 12165.25, 12195.25,
                        12225.25, 12255.25, 12285.25, 12315.25, 12345.25, 12375.25, 12405.25, 12435.25, 12465.25,
                        12495.25, 12525.25, 12555.25, 12585.25, 12615.25, 12645.25, 12675.25, 12705.25, 12735.25,
                        12765.25, 12795.25, 12825.25, 12855.25, 12885.25, 12915.25, 12945.25, 12975.25, 13005.25,
                        13035.25, 13065.25, 13095.25, 13125.25, 13155.25, 13185.25, 13215.25, 13245.25, 13275.25,
                        13305.25, 13335.25, 13365.25, 13395.25, 13425.25, 13455.25, 13485.25, 13515.25, 13545.25,
                        13575.25, 13605.25, 13635.25, 13665.25, 13695.25, 13725.25, 13755.25, 13785.25, 13815.25,
                        13845.25, 13875.25, 13905.25, 13935.25, 13965.25, 13995.25, 14025.25, 14055.25, 14085.25,
                        14115.25, 14145.25, 14175.25, 14205.25, 14235.25, 14265.25, 14295.25, 14325.25, 14355.25,
                        14385.25, 14415.25, 14445.25, 14475.25, 14505.25, 14535.25, 14565.25, 14595.25, 14625.25,
                        14655.25, 14685.25, 14715.25, 14745.25, 14775.25, 14805.25, 14835.25, 14865.25, 14895.25,
                        14925.25, 14955.25, 14985.25, 15015.25, 15045.25, 15075.25, 15105.25, 15135.25, 15165.25,
                        15195.25, 15225.25, 15255.25, 15285.25, 15315.25, 15345.25, 15375.25, 15405.25, 15435.25,
                        15465.25, 15495.25, 15525.25, 15555.25, 15585.25, 15615.25, 15645.25, 15675.25, 15705.25,
                        15735.25, 15765.25, 15795.25, 15825.25, 15855.25, 15885.25, 15915.25, 15945.25, 15975.25,
                        16005.25, 16035.25, 16065.25, 16095.25, 16125.25, 16155.25, 16185.25, 16215.25, 16245.25,
                        16275.25, 16305.25, 16335.25, 16365.25, 16395.25, 16425.25, 16455.25, 16485.25, 16515.25,
                        16545.25, 16575.25, 16605.25, 16635.25, 16665.25, 16695.25, 16725.25, 16755.25, 16785.25,
                        16815.25, 16845.25, 16875.25, 16905.25, 16935.25, 16965.25, 16995.25, 17025.25, 17055.25,
                        17085.25, 17115.25, 17145.25, 17175.25, 17205.25, 17235.25, 17265.25, 17295.25, 17325.25,
                        17355.25, 17385.25, 17415.25, 17445.25, 17475.25, 17505.25, 17535.25, 17565.25, 17595.25,
                        17625.25, 17655.25, 17685.25, 17715.25, 17745.25, 17775.25, 17805.25, 17835.25, 17865.25,
                        17895.25, 17925.25, 17955.25, 17985.25, 18015.25, 18045.25, 18075.25, 18105.25, 18135.25,
                        18165.25, 18195.25, 18225.25, 18255.25, 18285.25, 18315.25, 18345.25, 18375.25, 18405.25,
                        18435.25, 18465.25, 18495.25, 18525.25, 18555.25, 18585.25, 18615.25, 18645.25, 18675.25,
                        18705.25, 18735.25, 18765.25, 18795.25, 18825.25, 18855.25, 18885.25, 18915.25, 18945.25,
                        18975.25, 19005.25, 19035.25, 19065.25, 19095.25, 19125.25, 19155.25, 19185.25, 19215.25,
                        19245.25, 19275.25, 19305.25, 19335.25, 19365.25, 19395.25, 19425.25, 19455.25, 19485.25,
                        19515.25, 19545.25, 19575.25, 19605.25, 19635.25, 19665.25, 19695.25, 19725.25, 19755.25,
                        19785.25, 19815.25, 19845.25, 19875.25, 19905.25, 19935.25, 19965.25, 19995.25, 20025.25,
                        20055.25, 20085.25, 20115.25, 20145.25, 20175.25, 20205.25, 20235.25, 20265.25, 20295.25,
                        20325.25, 20355.25, 20385.25, 20415.25, 20445.25, 20475.25, 20505.25, 20535.25, 20565.25,
                        20595.25, 20625.25, 20655.25, 20685.25, 20715.25, 20745.25, 20775.25, 20805.25, 20835.25,
                        20865.25, 20895.25, 20925.25, 20955.25, 20985.25, 21015.25, 21045.25, 21075.25, 21105.25,
                        21135.25, 21165.25, 21195.25, 21225.25, 21255.25, 21285.25, 21315.25, 21345.25, 21375.25,
                        21405.25, 21435.25, 21465.25, 21495.25, 21525.25, 21555.25, 21585.25, 21615.25, 21645.25,
                        21675.25, 21705.25, 21735.25, 21765.25, 21795.25, 21825.25, 21855.25, 21885.25, 21915.25,
                        21945.25, 21975.25, 22005.25, 22035.25, 22065.25, 22095.25, 22125.25, 22155.25, 22185.25,
                        22215.25, 22245.25, 22275.25, 22305.25, 22335.25, 22365.25, 22395.25, 22425.25, 22455.25,
                        22485.25, 22515.25, 22545.25, 22575.25, 22605.25, 22635.25, 22665.25, 22695.25, 22725.25,
                        22755.25, 22785.25, 22815.25, 22845.25, 22875.25, 22905.25, 22935.25, 22965.25, 22995.25,
                        23025.25, 23055.25, 23085.25, 23115.25, 23145.25, 23175.25, 23205.25, 23235.25, 23265.25,
                        23295.25, 23325.25, 23355.25, 23385.25, 23415.25, 23445.25, 23475.25, 23505.25, 23535.25,
                        23565.25, 23595.25, 23625.25, 23655.25, 23685.25, 23715.25, 23745.25, 23775.25, 23805.25,
                        23835.25, 23865.25, 23895.25, 23925.25, 23955.25, 23985.25, 24015.25, 24045.25, 24075.25,
                        24105.25, 24135.25, 24165.25, 24195.25, 24225.25, 24255.25, 24285.25, 24315.25, 24345.25,
                        24375.25, 24405.25, 24435.25, 24465.25, 24495.25, 24525.25, 24555.25, 24585.25, 24615.25,
                        24645.25, 24675.25, 24705.25, 24735.25, 24765.25, 24795.25, 24825.25, 24855.25, 24885.25,
                        24915.25, 24945.25, 24975.25, 25005.25, 25035.25, 25065.25, 25095.25, 25125.25, 25155.25,
                        25185.25, 25215.25, 25245.25, 25275.25, 25305.25, 25335.25, 25365.25, 25395.25, 25425.25,
                        25455.25],
        "mins_in_0": 16.5, "mins_in_1": 15.5, "mins_in_2": 164.0, "mins_in_3": 60.0, "mins_in_4": 128.5,
        "sleep_efficiency": 0.9570871261378413, "total_sleep_time": 368.0
    }

    assert (dict_out == correct_return)
